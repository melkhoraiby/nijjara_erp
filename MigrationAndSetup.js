/**
 * Seeds an admin user (mkhoraiby, password 210388) into SYS_Users sheet.
 */
/**
 * Adds the Nijjara ERP Setup menu to the Google Sheet UI when opened.
 */
function onOpen() {
  SpreadsheetApp.getUi()
    .createMenu('Nijjara ERP Setup')
    .addItem('Run Setup', 'runSetup')
    .addItem('Seed System Data', 'seedSysSettings')
    .addItem('Seed Roles', 'seedSysRoles')
    .addItem('Seed Dropdowns', 'seedSysDropdowns')
    .addItem('Seed Tabs Register', 'seedSysTabRegister')
    .addItem('Seed Profile View', 'seedSysProfileView')
    .addItem('Seed Permissions', 'seedSysPermissions')
    .addItem('Seed Dynamic Forms', 'seedSysDynamicForms')
    .addItem('Create Admin User', 'seedAdminUser')
    .addItem('Seed Arabic L10N', 'seedArabicLocalization')
    .addToUi();
}

/**
 * MigrationAndSetup.gs
 * Single-run bootstrap for Nijjara ERP (Projects + Finance + HR + SYS).
 *
 * Usage:
 * 1. Create a new Google Spreadsheet and open Apps Script.
 * 2. Paste this file and save.
 * 3. Run runSetup() from the editor.
 *
 * Effects:
 * - Creates all required sheets (exact names).
 * - Removes sheets not listed in allowedSheets.
 * - Writes header row for each sheet (bold + grey background).
 * - Seeds SYS_Roles, SYS_Permissions, SYS_Dropdowns, SYS_Profile_View, SYS_Dynamic_Forms.
 * - Creates admin user "mkhoraiby" with password hash of "210388" (salted SHA-256).
 *
 * WARNING: This will remove any sheets not in the allowed list.
 */

const ADMIN_USERNAME = 'mkhoraiby';
const ADMIN_PASSWORD_PLAINTEXT = '210388'; // only used to create salted hash; not stored in plain
const ADMIN_EMAIL = 'mkhoraiby@example.com';
const SYSTEM_USER = 'SYSTEM';

function runSetup() {
  const ss = getSpreadsheet();
  const allowedSheets = getAllSheetNames();
  // ...existing code...
  removeUnwantedSheets(ss, allowedSheets);

  // Create each sheet & write headers
  const schema = getSheetSchemas();
  for (const shName in schema) {
    createOrResetSheet(ss, shName, schema[shName]);
  }

  // Seed system sheets
  seedSysSettings(ss);
  seedSysRoles(ss);
  seedSysDropdowns(ss);
  seedSysTabRegister(ss);
  seedSysProfileView(ss);
  seedSysPermissions(ss);
  seedSysDynamicForms(ss);

  // Create admin user (salt + sha256 hash)
  seedAdminUser(ss, ADMIN_USERNAME, ADMIN_EMAIL, ADMIN_PASSWORD_PLAINTEXT);

  // Create empty audit log header row already created by createOrResetSheet
  // Final message
  Logger.log('runSetup complete. Sheets created: ' + Object.keys(schema).join(', '));
  SpreadsheetApp.getUi().alert(
    'runSetup() complete — check the spreadsheet. Admin user created: ' + ADMIN_USERNAME
  );
  // ...existing code...
}

/* ---------- Helpers ---------- */

function getAllSheetNames() {
  // List of allowed sheets (exact names)
  return [
    'SYS_Settings',
    'SYS_Audit_Report',
    'SYS_Documents',
    'SYS_Profile_View',
    'SYS_Tab_Register',
    'SYS_Dropdowns',
    'SYS_Dynamic_Forms',
    'SYS_Role_Permissions',
    'SYS_Users',
    'SYS_Roles',
    'SYS_Permissions',
    'SYS_Audit_Log',
    'SYS_Sessions',
    'SYS_User_Properties',
    'SYS_PubHolidays',

    'HR_Employees',
    'HR_Attendance',
    'HR_Leave_Requests',
    'HR_Absence_Deductions',
    'HR_Leave',
    'HR_Leave_Analysis',
    'HR_Advances',
    'HR_OverTime',
    'HR_Penalties',
    'HR_Deductions',
    'HR_Payroll',
    'HR_KPIs',

    'PRJ_Main',
    'PRJ_Tasks',
    'PRJ_Costs',
    'PRJ_Clients',
    'PRJ_Materials',
    'PRJ_InDirExp_Allocations',
    'PRJ_Schedule_Calc',
    'PRJ_Dashboard',
    'PRJ_KPIs',

    'FIN_DirectExpenses',
    'FIN_InDirExpense_Repeated',
    'FIN_InDirExpense_Once',
    'FIN_Project_Revenue',
    'FIN_Revenues',
    'FIN_Journal',
    'FIN_Custody',
    'FIN_GL_Totals',
    'FIN_KPIs',
  ];
}

function removeUnwantedSheets(ss, allowedNames) {
  const sheets = ss.getSheets();
  const allowedSet = new Set(allowedNames);
  for (let i = sheets.length - 1; i >= 0; i--) {
    const sh = sheets[i];
    const name = sh.getName();
    if (!allowedSet.has(name)) {
      ss.deleteSheet(sh);
      Logger.log('Deleted sheet: ' + name);
    }
  }
}

function createOrResetSheet(ss, sheetName, headers) {
  let sh = ss.getSheetByName(sheetName);
  if (!sh) {
    sh = ss.insertSheet(sheetName);
  } else {
    // clear data but keep sheet
    sh.clear({ contentsOnly: true });
  }
  // set headers
  const headerRow = headers.slice(); // array of strings
  sh.getRange(1, 1, 1, headerRow.length).setValues([headerRow]);
  // style: bold + grey background
  sh.getRange(1, 1, 1, headerRow.length).setFontWeight('bold').setBackground('#D9D9D9');
  // freeze header row
  sh.setFrozenRows(1);
  // set column widths (optional gentle default)
  for (let c = 1; c <= headerRow.length; c++) {
    sh.setColumnWidth(c, 140);
  }
}

/* ---------- Schemas for each sheet (headers exact order) ---------- */

function getSheetSchemas() {
  // each entry: sheetName: [headers...]
  return {
    SYS_Settings: [
      'Setting_Key',
      'Setting_Value',
      'Description_EN',
      'Updated_By',
      'Updated_At',
      'Created_At',
    ],
    SYS_Audit_Report: [
      'Audit_Id',
      'Entity',
      'Entity_Id',
      'Action',
      'Actor_Id',
      'Summary',
      'Details',
      'Scope',
      'Created_At',
    ],
    SYS_Documents: [
      'Doc_ID',
      'Entity',
      'Entity_ID',
      'File_Name',
      'Label',
      'Drive_File_ID',
      'Drive_URL',
      'Uploaded_By',
      'Created_At',
    ],
    SYS_Profile_View: [
      'View_ID',
      'Tab_ID',
      'Tab_Name',
      'Section_Header',
      'Mode',
      'Source_Sheet',
      'Where_Column',
      'Field_Column',
      'Field_Label',
      'Format',
      'Sort',
      'Role_ID',
    ],
    SYS_Tab_Register: [
      'Record_Type',
      'Tab_ID',
      'Tab_Label_EN',
      'Tab_Label_AR',
      'Sub_ID',
      'Sub_Label_EN',
      'Sub_Label_AR',
      'Route',
      'Sort_Order',
    ],
    SYS_Dropdowns: ['Key', 'English_Title', 'Arabic_Title', 'Is_Active', 'Sort_Order'],
    SYS_Dynamic_Forms: [
      'Form_ID',
      'Form_Title',
      'Tab_ID',
      'Tab_Name',
      'Section_Header',
      'Field_ID',
      'Field_Label',
      'Field_Type',
      'Source_Sheet',
      'Source_Range',
      'Mandatory',
      'Default_Value',
      'Dropdown_Key',
      'Target_Sheet',
      'Target_Column',
      'Role_ID',
    ],
    SYS_Users: getHeaders('SYS_Users') || [
      'User_Id',
      'Full_Name',
      'Username',
      'Email',
      'Job_Title',
      'Department',
      'Role_Id',
      'IsActive',
      'Disabled_At',
      'Disabled_By',
      'Password_Hash',
      'Last_Login',
      'Created_At',
      'Created_By',
      'Updated_At',
      'Updated_By',
      'External_Id',
      'MFA_Enabled',
      'Notes',
    ],
    SYS_Roles: getHeaders('SYS_Roles') || [
      'Role_Id',
      'Role_Title',
      'Description',
      'Is_System',
      'Created_At',
      'Created_By',
      'Updated_At',
      'Updated_By',
    ],
    SYS_Permissions: getHeaders('SYS_Permissions') || [
      'Permission_Key',
      'Permission_Label',
      'Description',
      'Category',
      'Created_At',
      'Created_By',
      'Updated_At',
      'Updated_By',
    ],
    SYS_Role_Permissions: getHeaders('SYS_Role_Permissions') || [
      'Role_Id',
      'Permission_Key',
      'Scope',
      'Allowed',
      'Constraints',
      'Created_At',
      'Created_By',
      'Updated_At',
      'Updated_By',
    ],
    SYS_Audit_Log: getHeaders('SYS_Audit_Log') || [
      'Audit_Id',
      'User_Id',
      'Sheet',
      'Action',
      'Target_Id',
      'Details',
      'Created_At',
    ],
    SYS_Sessions: getHeaders('SYS_Sessions') || [
      'Session_Id',
      'User_Id',
      'Device',
      'Ip_Address',
      'Auth_Token',
      'Created_At',
      'Last_Seen',
      'Revoked_At',
      'Revoked_By',
    ],
    SYS_User_Properties: getHeaders('SYS_User_Properties') || [
      'User_Id',
      'Property_Key',
      'Property_Value',
      'Created_At',
      'Created_By',
      'Updated_At',
      'Updated_By',
    ],
    SYS_PubHolidays: ['Pub_Holiday_Date', 'Pub_Holiday_Name'],

    HR_Employees: [
      'Employee_ID',
      'Full_Name_EN',
      'Full_Name_AR',
      'Date_of_Birth',
      'Gender',
      'National_ID',
      'Marital_Status',
      'Military_Status',
      'Mobile_Main',
      'Mobile_Sub',
      'Home_Address',
      'Email',
      'Emergency_Contact',
      'Relation',
      'EC_Mobile',
      'Job_Title',
      'Department',
      'Hire_Date',
      'Contract_Type',
      'Status',
      'Basic_Salary',
      'Allowances',
      'Deductions',
      'Created_At',
      'Created_By',
    ],
    HR_Attendance: [
      'Attendance_ID',
      'Employee_ID',
      'Date',
      'Check_In',
      'Check_Out',
      'Hours',
      'OT_Minutes',
      'OT_Amount',
      'Late_Minutes',
      'EarlyLeave_Minutes',
      'Overtime_Minutes',
      'Notes',
      'Status',
      'Created_At',
      'Created_By',
    ],
    HR_Leave_Requests: [
      'Leave_ID',
      'Employee_ID',
      'Leave_Type',
      'Start_Date',
      'End_Date',
      'Days_Count',
      'Days',
      'Approver',
      'Reason',
      'Notes',
      'Status',
      'Created_At',
      'Created_By',
    ],
    HR_Absence_Deductions: [
      'Absence_ID',
      'Employee_ID',
      'Absence_Date',
      'Absence_Type',
      'Duration',
      'Deduction_Amount',
      'Reason',
      'Status',
      'Entry_Date',
      'Entered_By',
    ],
    HR_Leave: [
      'Leave_ID',
      'Emp_ID',
      'Leave_Type',
      'Start_Date',
      'End_Date',
      'Days_Count',
      'Status',
      'Notes',
    ],
    HR_Leave_Analysis: [
      'Employee_ID',
      'Full_Name',
      'Annual_Leave_Count',
      'Sick_Leave_Count',
      'Emergency_Leave_Count',
      'Total_Leave_Days',
      '_',
    ],
    HR_Advances: [
      'Advance_ID',
      'Employee_ID',
      'Issue_Date',
      'Amount',
      'Settlement_Period',
      'Advance_Installment',
      'Notes',
      'Status',
      'Created_At',
    ],
    HR_OverTime: [
      'OverTime_ID',
      'Employee_ID',
      'Date',
      'OT_WorkDay',
      'OT_WorkDay_Amount',
      'OT_WeekEnd',
      'OT_WeekEnd_Amount',
      'OT_Public_Holiday',
      'OT_Public_Holiday_Amount',
      'Total_OT_Amount',
      'Created_At',
    ],
    HR_Penalties: ['Penalty_ID', 'Penalty_Name', 'Penalty_Rule', 'Notes', 'Created_At'],
    HR_Deductions: [
      'Deduction_ID',
      'Penalty_ID',
      'Employee_ID',
      'Date',
      'Deduction_Amount',
      'Created_At',
    ],
    HR_Payroll: [
      'Payroll_ID',
      'Employee_ID',
      'Start_Date',
      'End_Date',
      'Basic_Salary',
      'Total_OT_Amount',
      'Advance_Installment',
      'Deduction_Amount',
      'Net_Pay',
      'Status',
      'Created_At',
    ],
    HR_KPIs: ['Metric', 'Value', 'Notes'],

    PRJ_Main: [
      'Project_ID',
      'Project_Name',
      'Client_ID',
      'Client_Name',
      'Contract_ID',
      'Start_Date',
      'Planned_Days',
      'Planned_End_Date',
      'End_Date',
      'Status',
      'Notes',
      'Proj_Budget',
      'Budget',
      'Total_Pay_Received',
      'Total_Pay_Pending',
      'Planned_Material_Expense',
      'Actual_Material_Expense',
      'Planned_Materials',
      'Actual_Materials',
      'Manager',
      'Created_At',
      'Created_By',
    ],
    PRJ_Tasks: [
      'Task_ID',
      'Project_ID',
      'Task_Name',
      'Assignee_ID',
      'Planned_Start',
      'Planned_End',
      'Actual_Start',
      'Actual_End',
      'Status',
      'Created_At',
      'Created_By',
    ],
    PRJ_Costs: [
      'Cost_ID',
      'Project_ID',
      'Date',
      'Category',
      'Description',
      'Amount',
      'Created_At',
      'Created_By',
    ],
    PRJ_Clients: [
      'Client_ID',
      'Client_Name',
      'Client_Mobile_1',
      'Client_Mobile_2',
      'Client_Email',
      'Created_At',
    ],
    PRJ_Materials: [
      'Material_ID',
      'Name_AR',
      'Name_EN',
      'Category',
      'Subcategory',
      'Sub2',
      'Default_Unit',
      'Default_Price',
      'Active',
    ],
    PRJ_InDirExp_Allocations: [
      'Allocation_ID',
      'InDirExpense_Repeated_ID',
      'InDirExpense_Once_ID',
      'Project_ID',
      'Allocation_Method',
      'Allocation_Percentage',
      'Allocation_Amount',
      'Created_At',
    ],
    PRJ_Schedule_Calc: [
      'Project_ID',
      'Project_Name',
      'Start_Date',
      'Planned_Days',
      'Planned_End_Date',
      'Schedule_Flag',
    ],
    PRJ_Dashboard: [
      'Project_ID',
      'Project_Name',
      'Start_Date',
      'Planned_End_Date',
      'Status',
      'Actual_Material_Expense',
      'Total_Ind_Expense',
      'Total_Pay_Received',
      'Proj_Budget',
      'Profit',
      'Schedule_Flag',
      'Cost_Flag',
    ],
    PRJ_KPIs: ['Metric', 'Value', 'Notes'],

    FIN_DirectExpenses: [
      'Project_ID',
      'Date',
      'Category',
      'Level_1',
      'Level_2',
      'Unit',
      'Qty',
      'Unit_Price',
      'Amount',
      'VAT_Rate',
      'VAT_Amount',
      'Total_With_VAT',
      'Material_ID',
      'Material_Name',
      'Pay_Status',
      'Pay_Method',
      'Notes',
      'Created_At',
      'Created_By',
      'Updated_At',
      'Updated_By',
    ],
    FIN_InDirExpense_Repeated: [
      'InDirExpense_Repeated_ID',
      'Category',
      'Sub_Category',
      'Pay_Date',
      'Start_Date',
      'End_Date',
      'Paid_By',
      'Pay_Status',
      'Pay_Method',
      'Amount',
      'Notes',
      'Allocation_Method',
      'Created_At',
    ],
    FIN_InDirExpense_Once: [
      'InDirExpense_Once_ID',
      'Category',
      'Sub_Category',
      'Pay_Date',
      'Yearly_Worth',
      'Useful_Life_Months',
      'Depreciation_Start_Date',
      'Paid_By',
      'Pay_Status',
      'Pay_Method',
      'Notes',
      'Allocation_Method',
      'Created_At',
    ],
    FIN_Project_Revenue: [
      'Revenue_ID',
      'Project_ID',
      'Revenue_Date',
      'Amount',
      'Source',
      'Pay_Method',
      'Invoice_Number',
      'Pay_Status',
      'Created_At',
    ],
    FIN_Revenues: [
      'Revenue_ID',
      'Date',
      'Client_ID',
      'Project_ID',
      'Amount',
      'Method',
      'Reference',
      'Notes',
      'Created_At',
      'Created_By',
    ],
    FIN_Journal: [
      'Journal_ID',
      'Date',
      'Account_Dr',
      'Account_Cr',
      'Amount',
      'Project_ID',
      'Memo',
      'Created_At',
      'Created_By',
    ],
    FIN_Custody: [
      'Custody_ID',
      'Employee_ID',
      'Employee_Name',
      'Issue_Date',
      'Custody_Amount',
      'Status',
      'Notes',
      'Created_At',
    ],
    FIN_GL_Totals: [
      'Date',
      'DirectExpense_ID',
      'InDirExpense_Repeated_ID',
      'InDirExpense_Once_ID',
      'Revenue_ID',
      'Net',
      'Month',
      'Created_At',
    ],
    FIN_KPIs: ['Metric', 'Value', 'Notes'],
  };
}

/* ---------- Seeding SYS data ---------- */

function seedSysSettings(ss) {
  const sh = ss.getSheetByName('SYS_Settings');
  const now = new Date();
  const rows = [
    ['APP_NAME', 'Nijjara_ERP', 'Application name', SYSTEM_USER, now, now],
    ['DEFAULT_CURRENCY', 'EGP', 'Default currency', SYSTEM_USER, now, now],
    ['BOOTSTRAP_TIMESTAMP', now.toISOString(), 'Boot timestamp', SYSTEM_USER, now, now],
  ];
  appendRowsIfEmpty(sh, rows);
}

function seedSysRoles(ss) {
  const sh = ss.getSheetByName('SYS_Roles');
  const nowIso = ensureISODate(new Date());
  const roles = [
    [
      'Admin',
      'Administrator',
      'Full system administrator',
      true,
      nowIso,
      SYSTEM_USER,
      nowIso,
      SYSTEM_USER,
    ],
    [
      'HR_Manager',
      'HR Manager',
      'Manages human resources data',
      false,
      nowIso,
      SYSTEM_USER,
      nowIso,
      SYSTEM_USER,
    ],
    [
      'Manager',
      'Manager',
      'Department manager with limited scope',
      false,
      nowIso,
      SYSTEM_USER,
      nowIso,
      SYSTEM_USER,
    ],
    [
      'Basic_User',
      'Basic User',
      'General access with limited rights',
      false,
      nowIso,
      SYSTEM_USER,
      nowIso,
      SYSTEM_USER,
    ],
    [
      'ROLE_Admin',
      'Legacy Admin',
      'Legacy role mapping',
      true,
      nowIso,
      SYSTEM_USER,
      nowIso,
      SYSTEM_USER,
    ],
    [
      'ROLE_Project_Manager',
      'Project Manager',
      'Manage projects and tasks',
      false,
      nowIso,
      SYSTEM_USER,
      nowIso,
      SYSTEM_USER,
    ],
    [
      'ROLE_Finance',
      'Finance',
      'Finance operations',
      false,
      nowIso,
      SYSTEM_USER,
      nowIso,
      SYSTEM_USER,
    ],
    [
      'ROLE_Accountant',
      'Accountant',
      'Accounting & journal posting',
      false,
      nowIso,
      SYSTEM_USER,
      nowIso,
      SYSTEM_USER,
    ],
    [
      'ROLE_Purchasing',
      'Purchasing',
      'Materials & procurement',
      false,
      nowIso,
      SYSTEM_USER,
      nowIso,
      SYSTEM_USER,
    ],
    ['ROLE_Sales', 'Sales', 'Clients & contracts', false, nowIso, SYSTEM_USER, nowIso, SYSTEM_USER],
    ['ROLE_HR', 'HR', 'Human resources', false, nowIso, SYSTEM_USER, nowIso, SYSTEM_USER],
    [
      'ROLE_Payroll',
      'Payroll',
      'Payroll operations',
      false,
      nowIso,
      SYSTEM_USER,
      nowIso,
      SYSTEM_USER,
    ],
    [
      'ROLE_Manager',
      'Legacy Manager',
      'Legacy department manager',
      false,
      nowIso,
      SYSTEM_USER,
      nowIso,
      SYSTEM_USER,
    ],
  ];
  appendRowsIfEmpty(sh, roles);
}

function seedSysDropdowns(ss) {
  const sh = ss.getSheetByName('SYS_Dropdowns');
  // Key | English_Title | Arabic_Title | Is_Active | Sort_Order
  const rows = [
    ['DD_Genders', 'Genders', 'الجنس', true, 1],
    ['DD_Marital_Status', 'Marital Status', 'الحالة الاجتماعية', true, 2],
    ['DD_Military_Status', 'Military Status', 'الحالة العسكرية', true, 3],
    ['DD_Departments', 'Departments', 'الأقسام', true, 4],
    ['DD_Contract_Types', 'Contract Types', 'نوع العقد', true, 5],
    ['DD_Attendance_Status', 'Attendance Status', 'حالة الحضور', true, 6],
    ['DD_Leave_Types', 'Leave Types', 'نوع الإجازة', true, 7],
    ['DD_Leave_Status', 'Leave Status', 'حالة الإجازة', true, 8],
    ['DD_Absence_Types', 'Absence Types', 'نوع الغياب', true, 9],
    ['DD_Penalties', 'Penalties', 'الغرامات', true, 10],
    ['DD_Deduction_Status', 'Deduction Status', 'حالة الخصم', true, 11],
    ['DD_Payroll_Status', 'Payroll Status', 'حالة الرواتب', true, 12],
    ['DD_Payment_Methods', 'Payment Methods', 'طرق الدفع', true, 13],
    ['DD_Pay_Status', 'Pay Status', 'حالة الدفع', true, 14],
    ['DD_Payment_Method', 'Payment Method', 'طريقة الدفع', true, 15],
    ['DD_Cost_Categories', 'Cost Categories', 'فئات التكلفة', true, 16],
    ['DD_Indirect_Methods', 'Indirect Allocation Methods', 'طرق التخصيص', true, 17],
    ['DD_Units', 'Units', 'الوحدات', true, 18],
    ['DD_GL_Periods', 'GL Periods', 'الفترات المحاسبية', true, 19],
    ['DD_Revenue_Sources', 'Revenue Sources', 'مصادر الإيراد', true, 20],
    ['DD_Entities', 'Entities', 'الكيانات', true, 21],
    ['DD_Overtime_Types', 'OT Types', 'أنواع العمل الإضافي', true, 22],
    ['DD_Custody_Status', 'Custody Status', 'حالة العهدة', true, 23],
    ['DD_Payroll_Batch', 'Payroll Batch', 'دفعة_الرواتب', true, 24],
    ['DD_Users', 'Users', 'المستخدمون', true, 25],
    ['DD_Project_Status', 'Project Status', 'حالة المشروع', true, 26],
    ['DD_Project_Stage', 'Project Stage', 'مرحلة المشروع', true, 27],
    ['DD_Attachment_Entities', 'Attachment Entities', 'كيانات المرفقات', true, 28],
  ];
  appendRowsIfEmpty(sh, rows);
}

function seedSysProfileView(ss) {
  const sh = ss.getSheetByName('SYS_Profile_View');
  // View_ID | Tab_ID | Tab_Name | Section_Header | Mode | Source_Sheet | Where_Column | Field_Column | Field_Label | Format | Sort | Role_ID
  const rows = [
    [
      'PV_Finance_Overview',
      'Tab_Finance_Dashboard',
      'لوحة_التحكم_المالية',
      'Overview',
      'View',
      'FIN_GL_Totals',
      '',
      '',
      'نظرة مالية عامة',
      '',
      1,
      'ROLE_Finance',
    ],
    [
      'PV_Revenue',
      'Tab_Revenue',
      'الإيرادات',
      'Revenue',
      'View',
      'FIN_Project_Revenue',
      '',
      '',
      'الإيرادات',
      '',
      2,
      'ROLE_Finance',
    ],
    [
      'PV_Direct_Costs',
      'Tab_Direct_Costs',
      'المصروفات_المباشرة',
      'Direct Costs',
      'View',
      'PRJ_Costs',
      '',
      '',
      'المصروفات المباشرة',
      '',
      3,
      'ROLE_Finance',
    ],
    [
      'PV_Employees',
      'Tab_Employees',
      'الموظفين',
      'Employees',
      'View',
      'HR_Employees',
      '',
      '',
      'بيانات الموظف',
      '',
      1,
      'ROLE_HR',
    ],
    [
      'PV_HR_Overview',
      'Tab_HR_Dashboard',
      'لوحة_التحكم_الموارد_البشرية',
      'Overview',
      'View',
      'HR_KPIs',
      '',
      '',
      'نظرة عامة للموارد البشرية',
      '',
      2,
      'ROLE_HR',
    ],
    [
      'PV_Project_Overview',
      'Tab_Project',
      'المشروع',
      'Project Summary',
      'View',
      'PRJ_Main',
      '',
      '',
      'ملخص المشروع',
      '',
      1,
      'ROLE_Project_Manager',
    ],
    [
      'PV_SYS_User_Profile',
      'Tab_SYS_Profile',
      'الملف',
      'Profile',
      'View',
      'SYS_Users',
      'User_Id',
      'Full_Name',
      'Full Name',
      '',
      1,
      'ROLE_Admin',
    ],
    [
      'PV_SYS_User_Properties',
      'Tab_SYS_Properties',
      'الخصائص',
      'Properties',
      'View',
      'SYS_User_Properties',
      'User_Id',
      'Property_Key',
      'Property',
      '',
      2,
      'ROLE_Admin',
    ],
    [
      'PV_SYS_User_Documents',
      'Tab_SYS_Documents',
      'المستندات',
      'Documents',
      'View',
      'SYS_Documents',
      'Entity_ID',
      'File_Name',
      'Document',
      '',
      3,
      'ROLE_Admin',
    ],
    [
      'PV_SYS_User_Sessions',
      'Tab_SYS_Sessions',
      'الجلسات',
      'Sessions',
      'View',
      'SYS_Sessions',
      'User_Id',
      'Session_Id',
      'Session',
      '',
      4,
      'ROLE_Admin',
    ],
    [
      'PV_SYS_User_Audit',
      'Tab_SYS_Audit',
      'التدقيق',
      'Audit',
      'View',
      'SYS_Audit_Report',
      'Entity_Id',
      'Action',
      'Audit Entry',
      '',
      5,
      'ROLE_Admin',
    ],
  ];
  appendRowsIfEmpty(sh, rows);
}

function seedSysPermissions(ss) {
  const permissionsSheet = ss.getSheetByName('SYS_Permissions');
  const nowIso = ensureISODate(new Date());
  const catalog = [
    {
      key: PERMISSION_KEYS.VIEW_USERS,
      label: 'View Users',
      description: 'View the users directory and profiles.',
      category: 'USERS',
    },
    {
      key: PERMISSION_KEYS.CREATE_USER,
      label: 'Create Users',
      description: 'Create new system users.',
      category: 'USERS',
    },
    {
      key: PERMISSION_KEYS.EDIT_USER,
      label: 'Edit Users',
      description: 'Modify existing user records.',
      category: 'USERS',
    },
    {
      key: PERMISSION_KEYS.ASSIGN_ROLE,
      label: 'Assign Roles',
      description: 'Assign or change user roles.',
      category: 'USERS',
    },
    {
      key: PERMISSION_KEYS.DEACTIVATE_USER,
      label: 'Deactivate Users',
      description: 'Disable users and revoke sessions.',
      category: 'USERS',
    },
    {
      key: PERMISSION_KEYS.DELETE_USER,
      label: 'Delete Users',
      description: 'Soft delete users from the system.',
      category: 'USERS',
    },
    {
      key: PERMISSION_KEYS.RESET_PASSWORD,
      label: 'Reset Passwords',
      description: 'Issue temporary passwords for users.',
      category: 'SECURITY',
    },
    {
      key: PERMISSION_KEYS.VIEW_AUDIT,
      label: 'View Audit Log',
      description: 'Read audit log entries.',
      category: 'SECURITY',
    },
    {
      key: PERMISSION_KEYS.IMPERSONATE,
      label: 'Impersonate Users',
      description: 'Impersonate a user session.',
      category: 'SECURITY',
    },
    {
      key: PERMISSION_KEYS.EXPORT_USERS,
      label: 'Export Users',
      description: 'Export filtered user lists.',
      category: 'USERS',
    },
  ];

  const permissionRows = catalog.map(function (item) {
    return [
      item.key,
      item.label,
      item.description,
      item.category,
      nowIso,
      SYSTEM_USER,
      nowIso,
      SYSTEM_USER,
    ];
  });
  appendRowsIfEmpty(permissionsSheet, permissionRows);

  const rolePermSheet = ss.getSheetByName('SYS_Role_Permissions');
  const roleHeaders = getHeaders('SYS_Role_Permissions');
  const defaults = getDefaultRolePermissions();
  const roleRows = defaults.map(function (entry) {
    return roleHeaders.map(function (header) {
      if (header === 'Role_Id') return entry.Role_Id;
      if (header === 'Permission_Key') return entry.Permission_Key;
      if (header === 'Scope') return entry.Scope || 'GLOBAL';
      if (header === 'Allowed') return entry.Allowed ? true : false;
      if (header === 'Constraints') return entry.Constraints || '';
      if (header === 'Created_At' || header === 'Updated_At') return nowIso;
      if (header === 'Created_By' || header === 'Updated_By') return SYSTEM_USER;
      return '';
    });
  });
  appendRowsIfEmpty(rolePermSheet, roleRows);
}

/* ---------- SYS_Dynamic_Forms seeding (many rows) ---------- */
/*
  We'll seed a representative full set of forms for HR, Projects and Finance
  using the field lists we agreed on earlier in the conversation.
  Columns: Form_ID,Form_Title,Tab_ID,Tab_Name,Section_Header,Field_ID,Field_Label,Field_Type,Source_Sheet,Source_Range,Mandatory,Default_Value,Dropdown_Key,Target_Sheet,Target_Column,Role_ID
*/

function seedSysDynamicForms(ss) {
  const sh = ss.getSheetByName('SYS_Dynamic_Forms');
  const now = new Date();
  const rows = [];
  function add(row) {
    rows.push(row);
  }

  // --- HR: New Employee (full) ---
  add([
    'FORM_HR_NewEmployee',
    'نموذج_موظف_جديد',
    'Tab_Employees',
    'الموظفين',
    'البيانات_الشخصية',
    'HR_Employee_ID',
    'معرّف_الموظف',
    'Auto',
    '',
    '',
    'Yes',
    'AutoGenerate',
    '',
    'HR_Employees',
    'Employee_ID',
    'ROLE_HR',
  ]);
  add([
    'FORM_HR_NewEmployee',
    'نموذج_موظف_جديد',
    'Tab_Employees',
    'الموظفين',
    'البيانات_الشخصية',
    'HR_Full_Name_EN',
    'الاسم_بالانجليزي',
    'Text',
    '',
    '',
    'Yes',
    '',
    '',
    'HR_Employees',
    'Full_Name_EN',
    'ROLE_HR',
  ]);
  add([
    'FORM_HR_NewEmployee',
    'نموذج_موظف_جديد',
    'Tab_Employees',
    'الموظفين',
    'البيانات_الشخصية',
    'HR_Full_Name_AR',
    'الاسم_بالعربية',
    'Text',
    '',
    '',
    'Yes',
    '',
    '',
    'HR_Employees',
    'Full_Name_AR',
    'ROLE_HR',
  ]);
  add([
    'FORM_HR_NewEmployee',
    'نموذج_موظف_جديد',
    'Tab_Employees',
    'الموظفين',
    'البيانات_الشخصية',
    'HR_Date_of_Birth',
    'تاريخ_الميلاد',
    'Date',
    '',
    '',
    'No',
    '',
    '',
    'HR_Employees',
    'Date_of_Birth',
    'ROLE_HR',
  ]);
  add([
    'FORM_HR_NewEmployee',
    'نموذج_موظف_جديد',
    'Tab_Employees',
    'الموظفين',
    'الهوية_والتواصل',
    'HR_Gender',
    'الجنس',
    'Dropdown',
    'SYS_Dropdowns',
    'Key=DD_Genders',
    'Yes',
    '',
    'DD_Genders',
    'HR_Employees',
    'Gender',
    'ROLE_HR',
  ]);
  add([
    'FORM_HR_NewEmployee',
    'نموذج_موظف_جديد',
    'Tab_Employees',
    'الموظفين',
    'الهوية_والتواصل',
    'HR_National_ID',
    'الرقم_الوطني',
    'Text',
    '',
    '',
    'No',
    '',
    '',
    'HR_Employees',
    'National_ID',
    'ROLE_HR',
  ]);
  add([
    'FORM_HR_NewEmployee',
    'نموذج_موظف_جديد',
    'Tab_Employees',
    'الموظفين',
    'الحالة_العائلية',
    'HR_Marital_Status',
    'الحالة_الاجتماعية',
    'Dropdown',
    'SYS_Dropdowns',
    'Key=DD_Marital_Status',
    'No',
    '',
    'DD_Marital_Status',
    'HR_Employees',
    'Marital_Status',
    'ROLE_HR',
  ]);
  add([
    'FORM_HR_NewEmployee',
    'نموذج_موظف_جديد',
    'Tab_Employees',
    'الموظفين',
    'الحالة_العسكرية',
    'HR_Military_Status',
    'الحالة_العسكرية',
    'Dropdown',
    'SYS_Dropdowns',
    'Key=DD_Military_Status',
    'No',
    '',
    'DD_Military_Status',
    'HR_Employees',
    'Military_Status',
    'ROLE_HR',
  ]);
  add([
    'FORM_HR_NewEmployee',
    'نموذج_موظف_جديد',
    'Tab_Employees',
    'الموظفين',
    'التواصل',
    'HR_Mobile_Main',
    'الجوال_الرئيسي',
    'Text',
    '',
    '',
    'Yes',
    '',
    '',
    'HR_Employees',
    'Mobile_Main',
    'ROLE_HR',
  ]);
  add([
    'FORM_HR_NewEmployee',
    'نموذج_موظف_جديد',
    'Tab_Employees',
    'الموظفين',
    'التواصل',
    'HR_Mobile_Sub',
    'الجوال_الفرعي',
    'Text',
    '',
    '',
    'No',
    '',
    '',
    'HR_Employees',
    'Mobile_Sub',
    'ROLE_HR',
  ]);
  add([
    'FORM_HR_NewEmployee',
    'نموذج_موظف_جديد',
    'Tab_Employees',
    'الموظفين',
    'التواصل',
    'HR_Home_Address',
    'العنوان',
    'Text',
    '',
    '',
    'No',
    '',
    '',
    'HR_Employees',
    'Home_Address',
    'ROLE_HR',
  ]);
  add([
    'FORM_HR_NewEmployee',
    'نموذج_موظف_جديد',
    'Tab_Employees',
    'الموظفين',
    'التواصل',
    'HR_Email',
    'البريد_الإلكتروني',
    'Text',
    '',
    '',
    'No',
    '',
    '',
    'HR_Employees',
    'Email',
    'ROLE_HR',
  ]);
  add([
    'FORM_HR_NewEmployee',
    'نموذج_موظف_جديد',
    'Tab_Employees',
    'الموظفين',
    'الطوارئ',
    'HR_Emergency_Contact',
    'جهة_الاتصال_الطوارئ',
    'Text',
    '',
    '',
    'No',
    '',
    '',
    'HR_Employees',
    'Emergency_Contact',
    'ROLE_HR',
  ]);
  add([
    'FORM_HR_NewEmployee',
    'نموذج_موظف_جديد',
    'Tab_Employees',
    'الموظفين',
    'الطوارئ',
    'HR_Relation',
    'علاقة_الطوارئ',
    'Text',
    '',
    '',
    'No',
    '',
    '',
    'HR_Employees',
    'Relation',
    'ROLE_HR',
  ]);
  add([
    'FORM_HR_NewEmployee',
    'نموذج_موظف_جديد',
    'Tab_Employees',
    'الموظفين',
    'الطوارئ',
    'HR_EC_Mobile',
    'جوال_الطوارئ',
    'Text',
    '',
    '',
    'No',
    '',
    '',
    'HR_Employees',
    'EC_Mobile',
    'ROLE_HR',
  ]);
  add([
    'FORM_HR_NewEmployee',
    'نموذج_موظف_جديد',
    'Tab_Employees',
    'الموظفين',
    'العمل',
    'HR_Job_Title',
    'المسمى_الوظيفي',
    'Text',
    '',
    '',
    'Yes',
    '',
    '',
    'HR_Employees',
    'Job_Title',
    'ROLE_HR',
  ]);
  add([
    'FORM_HR_NewEmployee',
    'نموذج_موظف_جديد',
    'Tab_Employees',
    'الموظفين',
    'العمل',
    'HR_Department',
    'القسم',
    'Dropdown',
    'SYS_Dropdowns',
    'Key=DD_Departments',
    'Yes',
    '',
    'DD_Departments',
    'HR_Employees',
    'Department',
    'ROLE_HR',
  ]);
  add([
    'FORM_HR_NewEmployee',
    'نموذج_موظف_جديد',
    'Tab_Employees',
    'الموظفين',
    'التوظيف',
    'HR_Hire_Date',
    'تاريخ_التعيين',
    'Date',
    '',
    '',
    'Yes',
    'TODAY()',
    '',
    'HR_Employees',
    'Hire_Date',
    'ROLE_HR',
  ]);
  add([
    'FORM_HR_NewEmployee',
    'نموذج_موظف_جديد',
    'Tab_Employees',
    'الموظفين',
    'التوظيف',
    'HR_Contract_Type',
    'نوع_العقد',
    'Dropdown',
    'SYS_Dropdowns',
    'Key=DD_Contract_Types',
    'Yes',
    '',
    'DD_Contract_Types',
    'HR_Employees',
    'Contract_Type',
    'ROLE_HR',
  ]);
  add([
    'FORM_HR_NewEmployee',
    'نموذج_موظف_جديد',
    'Tab_Employees',
    'الموظفين',
    'التعويضات',
    'HR_Status',
    'الحالة',
    'Dropdown',
    'SYS_Dropdowns',
    'Key=DD_Payroll_Status',
    'No',
    'Active',
    'DD_Payroll_Status',
    'HR_Employees',
    'Status',
    'ROLE_HR',
  ]);
  add([
    'FORM_HR_NewEmployee',
    'نموذج_موظف_جديد',
    'Tab_Employees',
    'الموظفين',
    'التعويضات',
    'HR_Basic_Salary',
    'الراتب_الاساسي',
    'Currency',
    '',
    '',
    'Yes',
    '0',
    '',
    'HR_Employees',
    'Basic_Salary',
    'ROLE_Payroll',
  ]);
  add([
    'FORM_HR_NewEmployee',
    'نموذج_موظف_جديد',
    'Tab_Employees',
    'الموظفين',
    'التعويضات',
    'HR_Allowances',
    'البدلات',
    'Currency',
    '',
    '',
    'No',
    '0',
    '',
    'HR_Employees',
    'Allowances',
    'ROLE_Payroll',
  ]);
  add([
    'FORM_HR_NewEmployee',
    'نموذج_موظف_جديد',
    'Tab_Employees',
    'الموظفين',
    'التعويضات',
    'HR_Deductions',
    'الاستقطاعات',
    'Currency',
    '',
    '',
    'No',
    '0',
    '',
    'HR_Employees',
    'Deductions',
    'ROLE_Payroll',
  ]);
  add([
    'FORM_HR_NewEmployee',
    'نموذج_موظف_جديد',
    'Tab_Employees',
    'الموظفين',
    'التدقيق',
    'HR_Created_At',
    'تاريخ_الانشاء',
    'Auto',
    '',
    '',
    'Yes',
    '=NOW()',
    '',
    'HR_Employees',
    'Created_At',
    'ROLE_HR',
  ]);
  add([
    'FORM_HR_NewEmployee',
    'نموذج_موظف_جديد',
    'Tab_Employees',
    'الموظفين',
    'التدقيق',
    'HR_Created_By',
    'من_انشأ',
    'Auto',
    'SYS_Users',
    'A:C',
    'Yes',
    'current_user',
    '',
    'HR_Employees',
    'Created_By',
    'ROLE_HR',
  ]);

  // --- HR Attendance (full) ---
  add([
    'FORM_HR_Attendance',
    'نموذج_سجل_حضور',
    'Tab_Attendance',
    'الحضور',
    'إدخال_حضور',
    'HR_Attendance_ID',
    'Attendance_ID',
    'Auto',
    '',
    '',
    'Yes',
    'AutoGenerate',
    '',
    'HR_Attendance',
    'Attendance_ID',
    'ROLE_HR',
  ]);
  add([
    'FORM_HR_Attendance',
    'نموذج_سجل_حضور',
    'Tab_Attendance',
    'الحضور',
    'إدخال_حضور',
    'HR_Employee_ID',
    'الموظف',
    'Dropdown',
    'HR_Employees',
    'A:C',
    'Yes',
    '',
    'DD_Employees',
    'HR_Attendance',
    'Employee_ID',
    'ROLE_HR',
  ]);
  add([
    'FORM_HR_Attendance',
    'نموذج_سجل_حضور',
    'Tab_Attendance',
    'الحضور',
    'إدخال_حضور',
    'HR_Date',
    'التاريخ',
    'Date',
    '',
    '',
    'Yes',
    'TODAY()',
    '',
    'HR_Attendance',
    'Date',
    'ROLE_HR',
  ]);
  add([
    'FORM_HR_Attendance',
    'نموذج_سجل_حضور',
    'Tab_Attendance',
    'الحضور',
    'إدخال_حضور',
    'HR_Check_In',
    'وقت_الحضور',
    'Time',
    '',
    '',
    'No',
    '',
    '',
    'HR_Attendance',
    'Check_In',
    'ROLE_HR',
  ]);
  add([
    'FORM_HR_Attendance',
    'نموذج_سجل_حضور',
    'Tab_Attendance',
    'الحضور',
    'إدخال_حضور',
    'HR_Check_Out',
    'وقت_الانصراف',
    'Time',
    '',
    '',
    'No',
    '',
    '',
    'HR_Attendance',
    'Check_Out',
    'ROLE_HR',
  ]);
  add([
    'FORM_HR_Attendance',
    'نموذج_سجل_حضور',
    'Tab_Attendance',
    'الحضور',
    'حسابات',
    'HR_Hours',
    'الساعات',
    'Number',
    '',
    '',
    'No',
    'Computed',
    '',
    'HR_Attendance',
    'Hours',
    'ROLE_HR',
  ]);
  add([
    'FORM_HR_Attendance',
    'نموذج_سجل_حضور',
    'Tab_Attendance',
    'الحضور',
    'حسابات',
    'HR_OT_Minutes',
    'دقائق_الاضافي',
    'Number',
    '',
    '',
    'No',
    '0',
    '',
    'HR_Attendance',
    'OT_Minutes',
    'ROLE_HR',
  ]);
  add([
    'FORM_HR_Attendance',
    'نموذج_سجل_حضور',
    'Tab_Attendance',
    'الحضور',
    'حسابات',
    'HR_OT_Amount',
    'مبلغ_الاضافي',
    'Currency',
    '',
    '',
    'No',
    '0',
    '',
    'HR_Attendance',
    'OT_Amount',
    'ROLE_Payroll',
  ]);
  add([
    'FORM_HR_Attendance',
    'نموذج_سجل_حضور',
    'Tab_Attendance',
    'الحضور',
    'حسابات',
    'HR_Late_Minutes',
    'دقائق_التأخير',
    'Number',
    '',
    '',
    'No',
    '0',
    '',
    'HR_Attendance',
    'Late_Minutes',
    'ROLE_HR',
  ]);
  add([
    'FORM_HR_Attendance',
    'نموذج_سجل_حضور',
    'Tab_Attendance',
    'الحضور',
    'حسابات',
    'HR_EarlyLeave_Minutes',
    'دقائق_الخروج_المبكر',
    'Number',
    '',
    '',
    'No',
    '0',
    '',
    'HR_Attendance',
    'EarlyLeave_Minutes',
    'ROLE_HR',
  ]);
  add([
    'FORM_HR_Attendance',
    'نموذج_سجل_حضور',
    'Tab_Attendance',
    'الحضور',
    'ملاحظات',
    'HR_Notes',
    'ملاحظات',
    'Textarea',
    '',
    '',
    'No',
    '',
    '',
    'HR_Attendance',
    'Notes',
    'ROLE_HR',
  ]);
  add([
    'FORM_HR_Attendance',
    'نموذج_سجل_حضور',
    'Tab_Attendance',
    'الحضور',
    'حالة',
    'HR_Status',
    'الحالة',
    'Dropdown',
    'SYS_Dropdowns',
    'Key=DD_Attendance_Status',
    'No',
    'Present',
    'DD_Attendance_Status',
    'HR_Attendance',
    'Status',
    'ROLE_HR',
  ]);

  // --- HR Leave Request (full) ---
  add([
    'FORM_HR_LeaveRequest',
    'نموذج_طلب_اجازة',
    'Tab_Leave',
    'الإجازات',
    'طلب_اجازة',
    'HR_Leave_ID',
    'Leave_ID',
    'Auto',
    '',
    '',
    'Yes',
    'AutoGenerate',
    '',
    'HR_Leave_Requests',
    'Leave_ID',
    'ROLE_HR',
  ]);
  add([
    'FORM_HR_LeaveRequest',
    'نموذج_طلب_اجازة',
    'Tab_Leave',
    'الإجازات',
    'طلب_اجازة',
    'HR_Employee_ID',
    'الموظف',
    'Dropdown',
    'HR_Employees',
    'A:C',
    'Yes',
    'current_user',
    'DD_Employees',
    'HR_Leave_Requests',
    'Employee_ID',
    'ROLE_HR',
  ]);
  add([
    'FORM_HR_LeaveRequest',
    'نموذج_طلب_اجازة',
    'Tab_Leave',
    'الإجازات',
    'طلب_اجازة',
    'HR_Leave_Type',
    'نوع_الاجازة',
    'Dropdown',
    'SYS_Dropdowns',
    'Key=DD_Leave_Types',
    'Yes',
    '',
    'DD_Leave_Types',
    'HR_Leave_Requests',
    'Leave_Type',
    'ROLE_HR',
  ]);
  add([
    'FORM_HR_LeaveRequest',
    'نموذج_طلب_اجازة',
    'Tab_Leave',
    'الإجازات',
    'طلب_اجازة',
    'HR_Start_Date',
    'تاريخ_البداية',
    'Date',
    '',
    '',
    'Yes',
    '',
    '',
    'HR_Leave_Requests',
    'Start_Date',
    'ROLE_HR',
  ]);
  add([
    'FORM_HR_LeaveRequest',
    'نموذج_طلب_اجازة',
    'Tab_Leave',
    'الإجازات',
    'طلب_اجازة',
    'HR_End_Date',
    'تاريخ_الانتهاء',
    'Date',
    '',
    '',
    'Yes',
    '',
    '',
    'HR_Leave_Requests',
    'End_Date',
    'ROLE_HR',
  ]);
  add([
    'FORM_HR_LeaveRequest',
    'نموذج_طلب_اجازة',
    'Tab_Leave',
    'الإجازات',
    'طلب_اجازة',
    'HR_Days_Count',
    'عدد_الأيام',
    'Number',
    '',
    '',
    'Yes',
    'Computed',
    '',
    'HR_Leave_Requests',
    'Days_Count',
    'ROLE_HR',
  ]);
  add([
    'FORM_HR_LeaveRequest',
    'نموذج_طلب_اجازة',
    'Tab_Leave',
    'الإجازات',
    'طلب_اجازة',
    'HR_Approver',
    'جهة_الموافقة',
    'Dropdown',
    'SYS_Users',
    'A:C',
    'Yes',
    '',
    'DD_Approvers',
    'HR_Leave_Requests',
    'Approver',
    'ROLE_HR',
  ]);
  add([
    'FORM_HR_LeaveRequest',
    'نموذج_طلب_اجازة',
    'Tab_Leave',
    'الإجازات',
    'طلب_اجازة',
    'HR_Reason',
    'السبب',
    'Textarea',
    '',
    '',
    'Yes',
    '',
    '',
    'HR_Leave_Requests',
    'Reason',
    'ROLE_HR',
  ]);
  add([
    'FORM_HR_LeaveRequest',
    'نموذج_طلب_اجازة',
    'Tab_Leave',
    'الإجازات',
    'طلب_اجازة',
    'HR_Notes',
    'ملاحظات',
    'Textarea',
    '',
    '',
    'No',
    '',
    '',
    'HR_Leave_Requests',
    'Notes',
    'ROLE_HR',
  ]);
  add([
    'FORM_HR_LeaveRequest',
    'نموذج_طلب_اجازة',
    'Tab_Leave',
    'الإجازات',
    'طلب_اجازة',
    'HR_Status',
    'حالة_الطلب',
    'Dropdown',
    'SYS_Dropdowns',
    'Key=DD_Leave_Status',
    'Yes',
    'Pending',
    'DD_Leave_Status',
    'HR_Leave_Requests',
    'Status',
    'ROLE_HR',
  ]);

  // --- HR Leave Record (HR admin) ---
  add([
    'FORM_HR_LeaveRecord',
    'نموذج_تسجيل_اجازة',
    'Tab_Leave',
    'الإجازات',
    'تسجيل',
    'HR_Leave_Record_ID',
    'Leave_ID',
    'Auto',
    '',
    '',
    'Yes',
    'AutoGenerate',
    '',
    'HR_Leave',
    'Leave_ID',
    'ROLE_HR',
  ]);
  add([
    'FORM_HR_LeaveRecord',
    'نموذج_تسجيل_اجازة',
    'Tab_Leave',
    'الإجازات',
    'تسجيل',
    'HR_Emp_ID',
    'الموظف',
    'Dropdown',
    'HR_Employees',
    'A:C',
    'Yes',
    '',
    'DD_Employees',
    'HR_Leave',
    'Emp_ID',
    'ROLE_HR',
  ]);
  add([
    'FORM_HR_LeaveRecord',
    'نموذج_تسجيل_اجازة',
    'Tab_Leave',
    'الإجازات',
    'تسجيل',
    'HR_Leave_Type',
    'نوع_الاجازة',
    'Dropdown',
    'SYS_Dropdowns',
    'Key=DD_Leave_Types',
    'Yes',
    '',
    'DD_Leave_Types',
    'HR_Leave',
    'Leave_Type',
    'ROLE_HR',
  ]);
  add([
    'FORM_HR_LeaveRecord',
    'نموذج_تسجيل_اجازة',
    'Tab_Leave',
    'الإجازات',
    'تسجيل',
    'HR_Start_Date',
    'تاريخ_البداية',
    'Date',
    '',
    '',
    'Yes',
    '',
    '',
    'HR_Leave',
    'Start_Date',
    'ROLE_HR',
  ]);
  add([
    'FORM_HR_LeaveRecord',
    'نموذج_تسجيل_اجازة',
    'Tab_Leave',
    'الإجازات',
    'تسجيل',
    'HR_End_Date',
    'تاريخ_الانتهاء',
    'Date',
    '',
    '',
    'Yes',
    '',
    '',
    'HR_Leave',
    'End_Date',
    'ROLE_HR',
  ]);
  add([
    'FORM_HR_LeaveRecord',
    'نموذج_تسجيل_اجازة',
    'Tab_Leave',
    'الإجازات',
    'تسجيل',
    'HR_Days_Count',
    'عدد_الأيام',
    'Number',
    '',
    '',
    'Yes',
    'Computed',
    '',
    'HR_Leave',
    'Days_Count',
    'ROLE_HR',
  ]);
  add([
    'FORM_HR_LeaveRecord',
    'نموذج_تسجيل_اجازة',
    'Tab_Leave',
    'الإجازات',
    'تسجيل',
    'HR_Status',
    'الحالة',
    'Dropdown',
    'SYS_Dropdowns',
    'Key=DD_Leave_Status',
    'Yes',
    'Approved',
    'DD_Leave_Status',
    'HR_Leave',
    'Status',
    'ROLE_HR',
  ]);
  add([
    'FORM_HR_LeaveRecord',
    'نموذج_تسجيل_اجازة',
    'Tab_Leave',
    'الإجازات',
    'تسجيل',
    'HR_Notes',
    'ملاحظات',
    'Textarea',
    '',
    '',
    'No',
    '',
    '',
    'HR_Leave',
    'Notes',
    'ROLE_HR',
  ]);

  // --- HR Absence Deduction ---
  add([
    'FORM_HR_AbsenceDeduction',
    'نموذج_خصم_غياب',
    'Tab_HR_Policies',
    'سياسات_الخصم',
    'غياب',
    'HR_Absence_ID',
    'Absence_ID',
    'Auto',
    '',
    '',
    'Yes',
    'AutoGenerate',
    '',
    'HR_Absence_Deductions',
    'Absence_ID',
    'ROLE_Payroll',
  ]);
  add([
    'FORM_HR_AbsenceDeduction',
    'نموذج_خصم_غياب',
    'Tab_HR_Policies',
    'سياسات_الخصم',
    'غياب',
    'HR_Employee_ID',
    'الموظف',
    'Dropdown',
    'HR_Employees',
    'A:C',
    'Yes',
    '',
    'DD_Employees',
    'HR_Absence_Deductions',
    'Employee_ID',
    'ROLE_Payroll',
  ]);
  add([
    'FORM_HR_AbsenceDeduction',
    'نموذج_خصم_غياب',
    'Tab_HR_Policies',
    'سياسات_الخصم',
    'غياب',
    'HR_Absence_Date',
    'تاريخ_الغياب',
    'Date',
    '',
    '',
    'Yes',
    '',
    '',
    'HR_Absence_Deductions',
    'Absence_Date',
    'ROLE_Payroll',
  ]);
  add([
    'FORM_HR_AbsenceDeduction',
    'نموذج_خصم_غياب',
    'Tab_HR_Policies',
    'سياسات_الخصم',
    'غياب',
    'HR_Absence_Type',
    'نوع_الغياب',
    'Dropdown',
    'SYS_Dropdowns',
    'Key=DD_Absence_Types',
    'Yes',
    '',
    'DD_Absence_Types',
    'HR_Absence_Deductions',
    'Absence_Type',
    'ROLE_Payroll',
  ]);
  add([
    'FORM_HR_AbsenceDeduction',
    'نموذج_خصم_غياب',
    'Tab_HR_Policies',
    'سياسات_الخصم',
    'غياب',
    'HR_Duration',
    'المدة',
    'Number',
    '',
    '',
    'Yes',
    '1',
    '',
    'HR_Absence_Deductions',
    'Duration',
    'ROLE_Payroll',
  ]);
  add([
    'FORM_HR_AbsenceDeduction',
    'نموذج_خصم_غياب',
    'Tab_HR_Policies',
    'سياسات_الخصم',
    'غياب',
    'HR_Deduction_Amount',
    'مبلغ_الخصم',
    'Currency',
    '',
    '',
    'Yes',
    '0',
    '',
    'HR_Absence_Deductions',
    'Deduction_Amount',
    'ROLE_Payroll',
  ]);
  add([
    'FORM_HR_AbsenceDeduction',
    'نموذج_خصم_غياب',
    'Tab_HR_Policies',
    'سياسات_الخصم',
    'غياب',
    'HR_Reason',
    'سبب',
    'Textarea',
    '',
    '',
    'No',
    '',
    '',
    'HR_Absence_Deductions',
    'Reason',
    'ROLE_Payroll',
  ]);
  add([
    'FORM_HR_AbsenceDeduction',
    'نموذج_خصم_غياب',
    'Tab_HR_Policies',
    'سياسات_الخصم',
    'غياب',
    'HR_Status',
    'الحالة',
    'Dropdown',
    'SYS_Dropdowns',
    'Key=DD_Deduction_Status',
    'No',
    'Pending',
    'DD_Deduction_Status',
    'HR_Absence_Deductions',
    'Status',
    'ROLE_Payroll',
  ]);

  // --- HR Advance (full) ---
  add([
    'FORM_HR_Advance',
    'نموذج_سلفة_موظف',
    'Tab_Compensation',
    'التعويضات',
    'سلفة',
    'HR_Advance_ID',
    'Advance_ID',
    'Auto',
    '',
    '',
    'Yes',
    'AutoGenerate',
    '',
    'HR_Advances',
    'Advance_ID',
    'ROLE_HR',
  ]);
  add([
    'FORM_HR_Advance',
    'نموذج_سلفة_موظف',
    'Tab_Compensation',
    'التعويضات',
    'سلفة',
    'HR_Employee_ID',
    'الموظف',
    'Dropdown',
    'HR_Employees',
    'A:C',
    'Yes',
    '',
    'DD_Employees',
    'HR_Advances',
    'Employee_ID',
    'ROLE_HR',
  ]);
  add([
    'FORM_HR_Advance',
    'نموذج_سلفة_موظف',
    'Tab_Compensation',
    'التعويضات',
    'سلفة',
    'HR_Issue_Date',
    'تاريخ_الصرف',
    'Date',
    '',
    '',
    'Yes',
    'TODAY()',
    '',
    'HR_Advances',
    'Issue_Date',
    'ROLE_HR',
  ]);
  add([
    'FORM_HR_Advance',
    'نموذج_سلفة_موظف',
    'Tab_Compensation',
    'التعويضات',
    'سلفة',
    'HR_Amount',
    'المبلغ',
    'Currency',
    '',
    '',
    'Yes',
    '0',
    '',
    'HR_Advances',
    'Amount',
    'ROLE_HR',
  ]);
  add([
    'FORM_HR_Advance',
    'نموذج_سلفة_موظف',
    'Tab_Compensation',
    'التعويضات',
    'سلفة',
    'HR_Settlement_Period',
    'فترة_التسوية',
    'Number',
    '',
    '',
    'Yes',
    '3',
    '',
    'HR_Advances',
    'Settlement_Period',
    'ROLE_HR',
  ]);
  add([
    'FORM_HR_Advance',
    'نموذج_سلفة_موظف',
    'Tab_Compensation',
    'التعويضات',
    'سلفة',
    'HR_Advance_Installment',
    'قسط_السلفة',
    'Currency',
    '',
    '',
    'No',
    '0',
    '',
    'HR_Advances',
    'Advance_Installment',
    'ROLE_Payroll',
  ]);
  add([
    'FORM_HR_Advance',
    'نموذج_سلفة_موظف',
    'Tab_Compensation',
    'التعويضات',
    'سلفة',
    'HR_Notes',
    'ملاحظات',
    'Textarea',
    '',
    '',
    'No',
    '',
    '',
    'HR_Advances',
    'Notes',
    'ROLE_HR',
  ]);
  add([
    'FORM_HR_Advance',
    'نموذج_سلفة_موظف',
    'Tab_Compensation',
    'التعويضات',
    'سلفة',
    'HR_Status',
    'حالة',
    'Dropdown',
    'SYS_Dropdowns',
    'Key=DD_Payroll_Status',
    'No',
    'Issued',
    'DD_Payroll_Status',
    'HR_Advances',
    'Status',
    'ROLE_HR',
  ]);

  // --- HR OverTime (full) ---
  add([
    'FORM_HR_OverTime',
    'نموذج_سجل_اضافي',
    'Tab_OT',
    'العمل_الإضافي',
    'تسجيل_OT',
    'HR_OverTime_ID',
    'OverTime_ID',
    'Auto',
    '',
    '',
    'Yes',
    'AutoGenerate',
    '',
    'HR_OverTime',
    'OverTime_ID',
    'ROLE_HR',
  ]);
  add([
    'FORM_HR_OverTime',
    'نموذج_سجل_اضافي',
    'Tab_OT',
    'العمل_الإضافي',
    'تسجيل_OT',
    'HR_Employee_ID',
    'الموظف',
    'Dropdown',
    'HR_Employees',
    'A:C',
    'Yes',
    '',
    'DD_Employees',
    'HR_OverTime',
    'Employee_ID',
    'ROLE_HR',
  ]);
  add([
    'FORM_HR_OverTime',
    'نموذج_سجل_اضافي',
    'Tab_OT',
    'العمل_الإضافي',
    'تسجيل_OT',
    'HR_Date',
    'التاريخ',
    'Date',
    '',
    '',
    'Yes',
    'TODAY()',
    '',
    'HR_OverTime',
    'Date',
    'ROLE_HR',
  ]);
  add([
    'FORM_HR_OverTime',
    'نموذج_سجل_اضافي',
    'Tab_OT',
    'العمل_الإضافي',
    'تسجيل_OT',
    'HR_OT_WorkDay',
    'OT_يوم_عمل',
    'Number',
    '',
    '',
    'No',
    '0',
    '',
    'HR_OverTime',
    'OT_WorkDay',
    'ROLE_HR',
  ]);
  add([
    'FORM_HR_OverTime',
    'نموذج_سجل_اضافي',
    'Tab_OT',
    'العمل_الإضافي',
    'تسجيل_OT',
    'HR_OT_WorkDay_Amount',
    'مبلغ_OT_يوم_عمل',
    'Currency',
    '',
    '',
    'No',
    '0',
    '',
    'HR_OverTime',
    'OT_WorkDay_Amount',
    'ROLE_Payroll',
  ]);
  add([
    'FORM_HR_OverTime',
    'نموذج_سجل_اضافي',
    'Tab_OT',
    'العمل_الإضافي',
    'تسجيل_OT',
    'HR_OT_WeekEnd',
    'OT_عطلة',
    'Number',
    '',
    '',
    'No',
    '0',
    '',
    'HR_OverTime',
    'OT_WeekEnd',
    'ROLE_HR',
  ]);
  add([
    'FORM_HR_OverTime',
    'نموذج_سجل_اضافي',
    'Tab_OT',
    'العمل_الإضافي',
    'تسجيل_OT',
    'HR_OT_WeekEnd_Amount',
    'مبلغ_OT_عطلة',
    'Currency',
    '',
    '',
    'No',
    '0',
    '',
    'HR_OverTime',
    'OT_WeekEnd_Amount',
    'ROLE_Payroll',
  ]);
  add([
    'FORM_HR_OverTime',
    'نموذج_سجل_اضافي',
    'Tab_OT',
    'العمل_الإضافي',
    'تسجيل_OT',
    'HR_OT_Public_Holiday',
    'OT_عطلة_رسمية',
    'Number',
    '',
    '',
    'No',
    '0',
    '',
    'HR_OverTime',
    'OT_Public_Holiday',
    'ROLE_HR',
  ]);
  add([
    'FORM_HR_OverTime',
    'نموذج_سجل_اضافي',
    'Tab_OT',
    'العمل_الإضافي',
    'تسجيل_OT',
    'HR_OT_Public_Holiday_Amount',
    'مبلغ_OT_عطلة_رسمية',
    'Currency',
    '',
    '',
    'No',
    '0',
    '',
    'HR_OverTime',
    'OT_Public_Holiday_Amount',
    'ROLE_Payroll',
  ]);
  add([
    'FORM_HR_OverTime',
    'نموذج_سجل_اضافي',
    'Tab_OT',
    'العمل_الإضافي',
    'تسجيل_OT',
    'HR_Total_OT_Amount',
    'اجمالي_OT',
    'Currency',
    'HR_OverTime',
    'Total_OT_Amount',
    'No',
    'Computed',
    '',
    'HR_OverTime',
    'Total_OT_Amount',
    'ROLE_Payroll',
  ]);
  add([
    'FORM_HR_OverTime',
    'نموذج_سجل_اضافي',
    'Tab_OT',
    'العمل_الإضافي',
    'تسجيل_OT',
    'HR_Created_At',
    'تاريخ_الانشاء',
    'Auto',
    '',
    '',
    'Yes',
    '=NOW()',
    '',
    'HR_OverTime',
    'Created_At',
    'ROLE_HR',
  ]);

  // --- HR Penalty & Deduction ---
  add([
    'FORM_HR_Penalty',
    'نموذج_قاعدة_غرامة',
    'Tab_HR_Policies',
    'سياسات_الموارد_البشرية',
    'غرامة',
    'HR_Penalty_ID',
    'Penalty_ID',
    'Auto',
    '',
    '',
    'Yes',
    'AutoGenerate',
    '',
    'HR_Penalties',
    'Penalty_ID',
    'ROLE_HR',
  ]);
  add([
    'FORM_HR_Penalty',
    'نموذج_قاعدة_غرامة',
    'Tab_HR_Policies',
    'سياسات_الموارد_البشرية',
    'غرامة',
    'HR_Penalty_Name',
    'اسم_الغرامة',
    'Text',
    '',
    '',
    'Yes',
    '',
    '',
    'HR_Penalties',
    'Penalty_Name',
    'ROLE_HR',
  ]);
  add([
    'FORM_HR_Penalty',
    'نموذج_قاعدة_غرامة',
    'Tab_HR_Policies',
    'سياسات_الموارد_البشرية',
    'غرامة',
    'HR_Penalty_Rule',
    'قاعدة_الغرامة',
    'Textarea',
    '',
    '',
    'Yes',
    '',
    '',
    'HR_Penalties',
    'Penalty_Rule',
    'ROLE_HR',
  ]);
  add([
    'FORM_HR_Penalty',
    'نموذج_قاعدة_غرامة',
    'Tab_HR_Policies',
    'سياسات_الموارد_البشرية',
    'غرامة',
    'HR_Notes',
    'ملاحظات',
    'Textarea',
    '',
    '',
    'No',
    '',
    '',
    'HR_Penalties',
    'Notes',
    'ROLE_HR',
  ]);

  add([
    'FORM_HR_Deduction',
    'نموذج_خصم_موظف',
    'Tab_Compensation',
    'التعويضات',
    'خصم',
    'HR_Deduction_ID',
    'Deduction_ID',
    'Auto',
    '',
    '',
    'Yes',
    'AutoGenerate',
    '',
    'HR_Deductions',
    'Deduction_ID',
    'ROLE_Payroll',
  ]);
  add([
    'FORM_HR_Deduction',
    'نموذج_خصم_موظف',
    'Tab_Compensation',
    'التعويضات',
    'خصم',
    'HR_Penalty_ID',
    'قاعدة_الغرامة',
    'Dropdown',
    'HR_Penalties',
    'A:C',
    'Yes',
    '',
    'DD_Penalties',
    'HR_Deductions',
    'Penalty_ID',
    'ROLE_Payroll',
  ]);
  add([
    'FORM_HR_Deduction',
    'نموذج_خصم_موظف',
    'Tab_Compensation',
    'التعويضات',
    'خصم',
    'HR_Employee_ID',
    'الموظف',
    'Dropdown',
    'HR_Employees',
    'A:C',
    'Yes',
    '',
    'DD_Employees',
    'HR_Deductions',
    'Employee_ID',
    'ROLE_Payroll',
  ]);
  add([
    'FORM_HR_Deduction',
    'نموذج_خصم_موظف',
    'Tab_Compensation',
    'التعويضات',
    'خصم',
    'HR_Date',
    'التاريخ',
    'Date',
    '',
    '',
    'Yes',
    'TODAY()',
    '',
    'HR_Deductions',
    'Date',
    'ROLE_Payroll',
  ]);
  add([
    'FORM_HR_Deduction',
    'نموذج_خصم_موظف',
    'Tab_Compensation',
    'التعويضات',
    'خصم',
    'HR_Deduction_Amount',
    'مبلغ_الخصم',
    'Currency',
    '',
    '',
    'Yes',
    '0',
    '',
    'HR_Deductions',
    'Deduction_Amount',
    'ROLE_Payroll',
  ]);
  add([
    'FORM_HR_Deduction',
    'نموذج_خصم_موظف',
    'Tab_Compensation',
    'التعويضات',
    'خصم',
    'HR_Created_At',
    'تاريخ_الانشاء',
    'Auto',
    '',
    '',
    'Yes',
    '=NOW()',
    '',
    'HR_Deductions',
    'Created_At',
    'ROLE_Payroll',
  ]);

  // --- HR Payroll Run (full) ---
  add([
    'FORM_HR_PayrollRun',
    'نموذج_تشغيل_الرواتب',
    'Tab_Payroll',
    'الرواتب',
    'اعداد_الرواتب',
    'HR_Payroll_ID',
    'Payroll_ID',
    'Auto',
    '',
    '',
    'Yes',
    'AutoGenerate',
    '',
    'HR_Payroll',
    'Payroll_ID',
    'ROLE_Payroll',
  ]);
  add([
    'FORM_HR_PayrollRun',
    'نموذج_تشغيل_الرواتب',
    'Tab_Payroll',
    'الرواتب',
    'اعداد_الرواتب',
    'HR_Start_Date',
    'بداية_الفترة',
    'Date',
    '',
    '',
    'Yes',
    '',
    '',
    'HR_Payroll',
    'Start_Date',
    'ROLE_Payroll',
  ]);
  add([
    'FORM_HR_PayrollRun',
    'نموذج_تشغيل_الرواتب',
    'Tab_Payroll',
    'الرواتب',
    'اعداد_الرواتب',
    'HR_End_Date',
    'نهاية_الفترة',
    'Date',
    '',
    '',
    'Yes',
    '',
    '',
    'HR_Payroll',
    'End_Date',
    'ROLE_Payroll',
  ]);
  add([
    'FORM_HR_PayrollRun',
    'نموذج_تشغيل_الرواتب',
    'Tab_Payroll',
    'الرواتب',
    'الحساب',
    'HR_Basic_Salary',
    'مجموع_الرواتب_الاساسية',
    'Currency',
    'HR_Employees',
    'Basic_Salary',
    'Yes',
    'Computed',
    '',
    'HR_Payroll',
    'Basic_Salary',
    'ROLE_Payroll',
  ]);
  add([
    'FORM_HR_PayrollRun',
    'نموذج_تشغيل_الرواتب',
    'Tab_Payroll',
    'الرواتب',
    'الحساب',
    'HR_Total_OT_Amount',
    'اجمالي_OT',
    'Currency',
    'HR_OverTime',
    'Total_OT_Amount',
    'No',
    'Computed',
    '',
    'HR_Payroll',
    'Total_OT_Amount',
    'ROLE_Payroll',
  ]);
  add([
    'FORM_HR_PayrollRun',
    'نموذج_تشغيل_الرواتب',
    'Tab_Payroll',
    'الرواتب',
    'الحساب',
    'HR_Advance_Installment',
    'قسط_السلفة',
    'Currency',
    'HR_Advances',
    'Advance_Installment',
    'No',
    'Computed',
    '',
    'HR_Payroll',
    'Advance_Installment',
    'ROLE_Payroll',
  ]);
  add([
    'FORM_HR_PayrollRun',
    'نموذج_تشغيل_الرواتب',
    'Tab_Payroll',
    'الرواتب',
    'الحساب',
    'HR_Deduction_Amount',
    'مجموع_الخصومات',
    'Currency',
    'HR_Deductions',
    'Deduction_Amount',
    'No',
    'Computed',
    '',
    'HR_Payroll',
    'Deduction_Amount',
    'ROLE_Payroll',
  ]);
  add([
    'FORM_HR_PayrollRun',
    'نموذج_تشغيل_الرواتب',
    'Tab_Payroll',
    'الرواتب',
    'الحساب',
    'HR_Net_Pay',
    'صافي_الاستحقاق',
    'Currency',
    '',
    '',
    'No',
    'Computed',
    '',
    'HR_Payroll',
    'Net_Pay',
    'ROLE_Payroll',
  ]);
  add([
    'FORM_HR_PayrollRun',
    'نموذج_تشغيل_الرواتب',
    'Tab_Payroll',
    'الرواتب',
    'التدقيق',
    'HR_Status',
    'حالة',
    'Dropdown',
    'SYS_Dropdowns',
    'Key=DD_Payroll_Status',
    'Yes',
    'Draft',
    'DD_Payroll_Status',
    'HR_Payroll',
    'Status',
    'ROLE_Payroll',
  ]);
  add([
    'FORM_HR_PayrollRun',
    'نموذج_تشغيل_الرواتب',
    'Tab_Payroll',
    'الرواتب',
    'التدقيق',
    'HR_Created_At',
    'تاريخ_الانشاء',
    'Auto',
    '',
    '',
    'Yes',
    '=NOW()',
    '',
    'HR_Payroll',
    'Created_At',
    'ROLE_Payroll',
  ]);

  // --- HR KPI form ---
  add([
    'FORM_HR_KPI',
    'نموذج_مؤشرات_الموارد_البشرية',
    'Tab_HR_Dashboard',
    'لوحة_التحكم',
    'اضافة_مؤشر',
    'HR_KPI_Metric',
    'المقياس',
    'Text',
    'HR_KPIs',
    'Metric',
    'Yes',
    '',
    '',
    'HR_KPIs',
    'Metric',
    'ROLE_HR',
  ]);
  add([
    'FORM_HR_KPI',
    'نموذج_مؤشرات_الموارد_البشرية',
    'Tab_HR_Dashboard',
    'لوحة_التحكم',
    'اضافة_مؤشر',
    'HR_KPI_Value',
    'القيمة',
    'Number',
    'HR_KPIs',
    'Value',
    'Yes',
    '0',
    '',
    'HR_KPIs',
    'Value',
    'ROLE_HR',
  ]);
  add([
    'FORM_HR_KPI',
    'نموذج_مؤشرات_الموارد_البشرية',
    'Tab_HR_Dashboard',
    'لوحة_التحكم',
    'اضافة_مؤشر',
    'HR_KPI_Notes',
    'ملاحظات',
    'Textarea',
    'HR_KPIs',
    'Notes',
    'No',
    '',
    '',
    'HR_KPIs',
    'Notes',
    'ROLE_HR',
  ]);

  // --- SYS Attachment (full) ---
  add([
    'FORM_SYS_Attach',
    'نموذج_مرفق',
    'Tab_Documents',
    'المرفقات',
    'مرفق',
    'DOC_ID',
    'Doc_ID',
    'Auto',
    '',
    '',
    'Yes',
    'AutoGenerate',
    '',
    'SYS_Documents',
    'Doc_ID',
    'ROLE_HR',
  ]);
  add([
    'FORM_SYS_Attach',
    'نموذج_مرفق',
    'Tab_Documents',
    'المرفقات',
    'مرفق',
    'DOC_Entity',
    'الكيان',
    'Dropdown',
    '',
    'Key=DD_Entities',
    'Yes',
    '',
    'DD_Entities',
    'SYS_Documents',
    'Entity',
    'ROLE_HR',
  ]);
  add([
    'FORM_SYS_Attach',
    'نموذج_مرفق',
    'Tab_Documents',
    'المرفقات',
    'مرفق',
    'DOC_Entity_ID',
    'معرّف_الكيان',
    'Text',
    'HR_Employees,HR_Attendance,HR_Payroll,PRJ_Main',
    'A:A',
    'Yes',
    '',
    'DD_Entities',
    'SYS_Documents',
    'Entity_ID',
    'ROLE_HR',
  ]);
  add([
    'FORM_SYS_Attach',
    'نموذج_مرفق',
    'Tab_Documents',
    'المرفقات',
    'مرفق',
    'DOC_File',
    'الملف',
    'File',
    '',
    '',
    'Yes',
    '',
    '',
    'SYS_Documents',
    'Drive_File_ID',
    'ROLE_HR',
  ]);
  add([
    'FORM_SYS_Attach',
    'نموذج_مرفق',
    'Tab_Documents',
    'المرفقات',
    'مرفق',
    'DOC_Label',
    'التسمية',
    'Text',
    '',
    '',
    'No',
    '',
    '',
    'SYS_Documents',
    'Label',
    'ROLE_HR',
  ]);

  // --- Project: New Project (full) ---
  add([
    'FORM_PRJ_NewProject',
    'نموذج_مشروع_جديد',
    'Tab_Project',
    'المشروع',
    'تفاصيل',
    'PRJ_Project_ID',
    'Project_ID',
    'Auto',
    '',
    '',
    'Yes',
    'AutoGenerate',
    '',
    'PRJ_Main',
    'Project_ID',
    'ROLE_Project_Manager',
  ]);
  add([
    'FORM_PRJ_NewProject',
    'نموذج_مشروع_جديد',
    'Tab_Project',
    'المشروع',
    'تفاصيل',
    'PRJ_Project_Name',
    'اسم_المشروع',
    'Text',
    '',
    '',
    'Yes',
    '',
    '',
    'PRJ_Main',
    'Project_Name',
    'ROLE_Project_Manager',
  ]);
  add([
    'FORM_PRJ_NewProject',
    'نموذج_مشروع_جديد',
    'Tab_Project',
    'المشروع',
    'تفاصيل',
    'PRJ_Client_ID',
    'العميل',
    'Dropdown',
    'PRJ_Clients',
    'A:B',
    'No',
    '',
    'DD_Projects',
    'PRJ_Main',
    'Client_ID',
    'ROLE_Project_Manager',
  ]);
  add([
    'FORM_PRJ_NewProject',
    'نموذج_مشروع_جديد',
    'Tab_Project',
    'المشروع',
    'تفاصيل',
    'PRJ_Client_Name',
    'اسم_العميل',
    'Text',
    'PRJ_Clients',
    'Client_Name',
    'No',
    '',
    '',
    'PRJ_Main',
    'Client_Name',
    'ROLE_Project_Manager',
  ]);
  add([
    'FORM_PRJ_NewProject',
    'نموذج_مشروع_جديد',
    'Tab_Project',
    'المشروع',
    'تفاصيل',
    'PRJ_Contract_ID',
    'معرّف_العقد',
    'Text',
    '',
    '',
    'No',
    '',
    '',
    'PRJ_Main',
    'Contract_ID',
    'ROLE_Project_Manager',
  ]);
  add([
    'FORM_PRJ_NewProject',
    'نموذج_مشروع_جديد',
    'Tab_Project',
    'المشروع',
    'تفاصيل',
    'PRJ_Start_Date',
    'تاريخ_البدء',
    'Date',
    '',
    '',
    'Yes',
    'TODAY()',
    '',
    'PRJ_Main',
    'Start_Date',
    'ROLE_Project_Manager',
  ]);
  add([
    'FORM_PRJ_NewProject',
    'نموذج_مشروع_جديد',
    'Tab_Project',
    'المشروع',
    'تفاصيل',
    'PRJ_Planned_Days',
    'ايام_مخططة',
    'Number',
    '',
    '',
    'Yes',
    '0',
    '',
    'PRJ_Main',
    'Planned_Days',
    'ROLE_Project_Manager',
  ]);
  add([
    'FORM_PRJ_NewProject',
    'نموذج_مشروع_جديد',
    'Tab_Project',
    'المشروع',
    'تفاصيل',
    'PRJ_Planned_End_Date',
    'تاريخ_النهاية_المخطط',
    'Date',
    '',
    '',
    'No',
    'Computed',
    '',
    'PRJ_Main',
    'Planned_End_Date',
    'ROLE_Project_Manager',
  ]);
  add([
    'FORM_PRJ_NewProject',
    'نموذج_مشروع_جديد',
    'Tab_Project',
    'المشروع',
    'تفاصيل',
    'PRJ_End_Date',
    'تاريخ_الانتهاء',
    'Date',
    '',
    '',
    'No',
    '',
    '',
    'PRJ_Main',
    'End_Date',
    'ROLE_Project_Manager',
  ]);
  add([
    'FORM_PRJ_NewProject',
    'نموذج_مشروع_جديد',
    'Tab_Project',
    'المشروع',
    'تفاصيل',
    'PRJ_Status',
    'حالة',
    'Dropdown',
    'SYS_Dropdowns',
    'Key=DD_Project_Status',
    'No',
    'Planned',
    'DD_Project_Status',
    'PRJ_Main',
    'Status',
    'ROLE_Project_Manager',
  ]);
  add([
    'FORM_PRJ_NewProject',
    'نموذج_مشروع_جديد',
    'Tab_Project',
    'المشروع',
    'تفاصيل',
    'PRJ_Stage',
    'مرحلة',
    'Dropdown',
    'SYS_Dropdowns',
    'Key=DD_Project_Stage',
    'No',
    '',
    'DD_Project_Stage',
    'PRJ_Main',
    'Stage',
    'ROLE_Project_Manager',
  ]);
  add([
    'FORM_PRJ_NewProject',
    'نموذج_مشروع_جديد',
    'Tab_Project',
    'المشروع',
    'مالية',
    'PRJ_Proj_Budget',
    'ميزانية_المشروع',
    'Currency',
    '',
    '',
    'No',
    '0',
    '',
    'PRJ_Main',
    'Proj_Budget',
    'ROLE_Finance',
  ]);
  add([
    'FORM_PRJ_NewProject',
    'نموذج_مشروع_جديد',
    'Tab_Project',
    'المشروع',
    'مالية',
    'PRJ_Planned_Material_Expense',
    'مصاريف_المواد_المخططة',
    'Currency',
    '',
    '',
    'No',
    '0',
    '',
    'PRJ_Main',
    'Planned_Material_Expense',
    'ROLE_Project_Manager',
  ]);
  add([
    'FORM_PRJ_NewProject',
    'نموذج_مشروع_جديد',
    'Tab_Project',
    'المشروع',
    'مالية',
    'PRJ_Planned_Materials',
    'المواد_المخططة',
    'Text',
    'PRJ_Materials',
    'A:C',
    'No',
    '',
    '',
    'PRJ_Main',
    'Planned_Materials',
    'ROLE_Purchasing',
  ]);
  add([
    'FORM_PRJ_NewProject',
    'نموذج_مشروع_جديد',
    'Tab_Project',
    'المشروع',
    'ادارة',
    'PRJ_Manager',
    'المدير',
    'Dropdown',
    'SYS_Users',
    'A:C',
    'No',
    '',
    'DD_Users',
    'PRJ_Main',
    'Manager',
    'ROLE_Project_Manager',
  ]);
  add([
    'FORM_PRJ_NewProject',
    'نموذج_مشروع_جديد',
    'Tab_Project',
    'المشروع',
    'ملاحظات',
    'PRJ_Notes',
    'ملاحظات',
    'Textarea',
    '',
    '',
    'No',
    '',
    '',
    'PRJ_Main',
    'Notes',
    'ROLE_Project_Manager',
  ]);

  // --- Project: Task form ---
  add([
    'FORM_PRJ_Task',
    'نموذج_مهمة_مشروع',
    'Tab_Project',
    'المشروع',
    'المهام',
    'PRJ_Task_ID',
    'Task_ID',
    'Auto',
    '',
    '',
    'Yes',
    'AutoGenerate',
    '',
    'PRJ_Tasks',
    'Task_ID',
    'ROLE_Project_Manager',
  ]);
  add([
    'FORM_PRJ_Task',
    'نموذج_مهمة_مشروع',
    'Tab_Project',
    'المشروع',
    'المهام',
    'PRJ_Task_Project_ID',
    'المشروع',
    'Dropdown',
    'PRJ_Main',
    'A:B',
    'Yes',
    '',
    'DD_Projects',
    'PRJ_Tasks',
    'Project_ID',
    'ROLE_Project_Manager',
  ]);
  add([
    'FORM_PRJ_Task',
    'نموذج_مهمة_مشروع',
    'Tab_Project',
    'المشروع',
    'المهام',
    'PRJ_Task_Name',
    'اسم_المهمة',
    'Text',
    '',
    '',
    'Yes',
    '',
    '',
    'PRJ_Tasks',
    'Task_Name',
    'ROLE_Project_Manager',
  ]);
  add([
    'FORM_PRJ_Task',
    'نموذج_مهمة_مشروع',
    'Tab_Project',
    'المشروع',
    'المهام',
    'PRJ_Task_Assignee',
    'المكلف',
    'Dropdown',
    'SYS_Users',
    'A:C',
    'No',
    '',
    'DD_Users',
    'PRJ_Tasks',
    'Assignee_ID',
    'ROLE_Project_Manager',
  ]);
  add([
    'FORM_PRJ_Task',
    'نموذج_مهمة_مشروع',
    'Tab_Project',
    'المشروع',
    'المهام',
    'PRJ_Task_Planned_Start',
    'تاريخ_بداية_مخطط',
    'Date',
    '',
    '',
    'No',
    '',
    '',
    'PRJ_Tasks',
    'Planned_Start',
    'ROLE_Project_Manager',
  ]);
  add([
    'FORM_PRJ_Task',
    'نموذج_مهمة_مشروع',
    'Tab_Project',
    'المشروع',
    'المهام',
    'PRJ_Task_Planned_End',
    'تاريخ_نهاية_مخطط',
    'Date',
    '',
    '',
    'No',
    '',
    '',
    'PRJ_Tasks',
    'Planned_End',
    'ROLE_Project_Manager',
  ]);
  add([
    'FORM_PRJ_Task',
    'نموذج_مهمة_مشروع',
    'Tab_Project',
    'المشروع',
    'المهام',
    'PRJ_Task_Status',
    'حالة_المهمة',
    'Dropdown',
    'SYS_Dropdowns',
    'Key=DD_Project_Status',
    'No',
    'Open',
    'DD_Project_Status',
    'PRJ_Tasks',
    'Status',
    'ROLE_Project_Manager',
  ]);

  // --- Project: Costs (direct expense cart / checkout) ---
  add([
    'FORM_PRJ_Cost',
    'نموذج_مصاريف_مشروع',
    'Tab_Costs',
    'التكاليف',
    'مصاريف',
    'PRJ_Cost_ID',
    'Cost_ID',
    'Auto',
    '',
    '',
    'Yes',
    'AutoGenerate',
    '',
    'PRJ_Costs',
    'Cost_ID',
    'ROLE_Project_Manager',
  ]);
  add([
    'FORM_PRJ_Cost',
    'نموذج_مصاريف_مشروع',
    'Tab_Costs',
    'التكاليف',
    'مصاريف',
    'PRJ_Cost_Project_ID',
    'المشروع',
    'Dropdown',
    'PRJ_Main',
    'A:B',
    'Yes',
    '',
    'DD_Projects',
    'PRJ_Costs',
    'Project_ID',
    'ROLE_Project_Manager',
  ]);
  add([
    'FORM_PRJ_Cost',
    'نموذج_مصاريف_مشروع',
    'Tab_Costs',
    'التكاليف',
    'مصاريف',
    'PRJ_Cost_Date',
    'التاريخ',
    'Date',
    '',
    '',
    'Yes',
    'TODAY()',
    '',
    'PRJ_Costs',
    'Date',
    'ROLE_Project_Manager',
  ]);
  add([
    'FORM_PRJ_Cost',
    'نموذج_مصاريف_مشروع',
    'Tab_Costs',
    'التكاليف',
    'مصاريف',
    'PRJ_Cost_Category',
    'الفئة',
    'Dropdown',
    'SYS_Dropdowns',
    'Key=DD_Cost_Categories',
    'Yes',
    '',
    'DD_Cost_Categories',
    'PRJ_Costs',
    'Category',
    'ROLE_Project_Manager',
  ]);
  add([
    'FORM_PRJ_Cost',
    'نموذج_مصاريف_مشروع',
    'Tab_Costs',
    'التكاليف',
    'مصاريف',
    'PRJ_Cost_Description',
    'الوصف',
    'Textarea',
    '',
    '',
    'No',
    '',
    '',
    'PRJ_Costs',
    'Description',
    'ROLE_Project_Manager',
  ]);
  add([
    'FORM_PRJ_Cost',
    'نموذج_مصاريف_مشروع',
    'Tab_Costs',
    'التكاليف',
    'مصاريف',
    'PRJ_Cost_Amount',
    'المبلغ',
    'Currency',
    '',
    '',
    'Yes',
    '0',
    '',
    'PRJ_Costs',
    'Amount',
    'ROLE_Project_Manager',
  ]);
  add([
    'FORM_PRJ_Cost',
    'نموذج_مصاريف_مشروع',
    'Tab_Costs',
    'التكاليف',
    'مصاريف',
    'PRJ_Cost_Created_At',
    'تاريخ_الانشاء',
    'Auto',
    '',
    '',
    'Yes',
    '=NOW()',
    '',
    'PRJ_Costs',
    'Created_At',
    'ROLE_Project_Manager',
  ]);

  // --- Project: Materials catalog add/edit ---
  add([
    'FORM_PRJ_Material',
    'نموذج_مادة',
    'Tab_Materials',
    'المواد',
    'تعريف_المادة',
    'PRJ_Material_ID',
    'Material_ID',
    'Auto',
    '',
    '',
    'Yes',
    'AutoGenerate',
    '',
    'PRJ_Materials',
    'Material_ID',
    'ROLE_Purchasing',
  ]);
  add([
    'FORM_PRJ_Material',
    'نموذج_مادة',
    'Tab_Materials',
    'المواد',
    'تعريف_المادة',
    'PRJ_Material_Name_AR',
    'الاسم_بالعربية',
    'Text',
    '',
    '',
    'Yes',
    '',
    '',
    'PRJ_Materials',
    'Name_AR',
    'ROLE_Purchasing',
  ]);
  add([
    'FORM_PRJ_Material',
    'نموذج_مادة',
    'Tab_Materials',
    'المواد',
    'تعريف_المادة',
    'PRJ_Material_Name_EN',
    'الاسم_بالانجليزية',
    'Text',
    '',
    '',
    'No',
    '',
    '',
    'PRJ_Materials',
    'Name_EN',
    'ROLE_Purchasing',
  ]);
  add([
    'FORM_PRJ_Material',
    'نموذج_مادة',
    'Tab_Materials',
    'المواد',
    'تعريف_المادة',
    'PRJ_Material_Category',
    'الفئة',
    'Text',
    '',
    '',
    'No',
    '',
    '',
    'PRJ_Materials',
    'Category',
    'ROLE_Purchasing',
  ]);
  add([
    'FORM_PRJ_Material',
    'نموذج_مادة',
    'Tab_Materials',
    'المواد',
    'تعريف_المادة',
    'PRJ_Material_Default_Unit',
    'الوحدة_الافتراضية',
    'Text',
    '',
    '',
    'No',
    '',
    '',
    'PRJ_Materials',
    'Default_Unit',
    'ROLE_Purchasing',
  ]);
  add([
    'FORM_PRJ_Material',
    'نموذج_مادة',
    'Tab_Materials',
    'المواد',
    'تعريف_المادة',
    'PRJ_Material_Default_Price',
    'السعر_الافتراضي',
    'Currency',
    '',
    '',
    'No',
    '0',
    '',
    'PRJ_Materials',
    'Default_Price',
    'ROLE_Purchasing',
  ]);
  add([
    'FORM_PRJ_Material',
    'نموذج_مادة',
    'Tab_Materials',
    'المواد',
    'تعريف_المادة',
    'PRJ_Material_Active',
    'فعال',
    'Dropdown',
    '',
    'Key=DD_Users',
    'No',
    'TRUE',
    '',
    'PRJ_Materials',
    'Active',
    'ROLE_Purchasing',
  ]);

  // --- Project: Indirect expense allocation ---
  add([
    'FORM_PRJ_InDirAlloc',
    'نموذج_تخصيص_مصروف_غير_مباشر',
    'Tab_Indirect',
    'المصروفات_غير_مباشرة',
    'تخصيص',
    'PRJ_Alloc_ID',
    'Allocation_ID',
    'Auto',
    '',
    '',
    'Yes',
    'AutoGenerate',
    '',
    'PRJ_InDirExp_Allocations',
    'Allocation_ID',
    'ROLE_Finance',
  ]);
  add([
    'FORM_PRJ_InDirAlloc',
    'نموذج_تخصيص_مصروف_غير_مباشر',
    'Tab_Indirect',
    'المصروفات_غير_مباشرة',
    'تخصيص',
    'PRJ_InDir_ID',
    'InDirExpense_Repeated_ID',
    'Dropdown',
    'FIN_InDirExpense_Repeated',
    'A:A',
    'No',
    '',
    '',
    'PRJ_InDirExp_Allocations',
    'InDirExpense_Repeated_ID',
    'ROLE_Finance',
  ]);
  add([
    'FORM_PRJ_InDirAlloc',
    'نموذج_تخصيص_مصروف_غير_مباشر',
    'Tab_Indirect',
    'المصروفات_غير_مباشرة',
    'تخصيص',
    'PRJ_Project_ID',
    'المشروع',
    'Dropdown',
    'PRJ_Main',
    'A:B',
    'Yes',
    '',
    'DD_Projects',
    'PRJ_InDirExp_Allocations',
    'Project_ID',
    'ROLE_Finance',
  ]);
  add([
    'FORM_PRJ_InDirAlloc',
    'نموذج_تخصيص_مصروف_غير_مباشر',
    'Tab_Indirect',
    'المصروفات_غير_مباشرة',
    'تخصيص',
    'PRJ_Allocation_Method',
    'طريقة_التخصيص',
    'Dropdown',
    'SYS_Dropdowns',
    'Key=DD_Indirect_Methods',
    'Yes',
    '',
    'DD_Indirect_Methods',
    'PRJ_InDirExp_Allocations',
    'Allocation_Method',
    'ROLE_Finance',
  ]);
  add([
    'FORM_PRJ_InDirAlloc',
    'نموذج_تخصيص_مصروف_غير_مباشر',
    'Tab_Indirect',
    'المصروفات_غير_مباشرة',
    'تخصيص',
    'PRJ_Allocation_Percentage',
    'نسبة_التخصيص',
    'Number',
    '',
    '',
    'No',
    '0',
    '',
    'PRJ_InDirExp_Allocations',
    'Allocation_Percentage',
    'ROLE_Finance',
  ]);
  add([
    'FORM_PRJ_InDirAlloc',
    'نموذج_تخصيص_مصروف_غير_مباشر',
    'Tab_Indirect',
    'المصروفات_غير_مباشرة',
    'تخصيص',
    'PRJ_Allocation_Amount',
    'مبلغ_التخصيص',
    'Currency',
    '',
    '',
    'No',
    '0',
    '',
    'PRJ_InDirExp_Allocations',
    'Allocation_Amount',
    'ROLE_Finance',
  ]);

  // --- Finance: Direct Expense (cart-style) ---
  add([
    'FORM_FIN_DirectExpense',
    'نموذج_مصروف_مباشر',
    'Tab_DirectExpenses',
    'المصروفات_المباشرة',
    'تفاصيل',
    'FIN_DirectExpense_Project_ID',
    'المشروع',
    'Dropdown',
    'PRJ_Main',
    'A:B',
    'Yes',
    '',
    'DD_Projects',
    'FIN_DirectExpenses',
    'Project_ID',
    'ROLE_Finance',
  ]);
  add([
    'FORM_FIN_DirectExpense',
    'نموذج_مصروف_مباشر',
    'Tab_DirectExpenses',
    'المصروفات_المباشرة',
    'تفاصيل',
    'FIN_DirectExpense_Date',
    'التاريخ',
    'Date',
    '',
    '',
    'Yes',
    'TODAY()',
    '',
    'FIN_DirectExpenses',
    'Date',
    'ROLE_Finance',
  ]);
  add([
    'FORM_FIN_DirectExpense',
    'نموذج_مصروف_مباشر',
    'Tab_DirectExpenses',
    'المصروفات_المباشرة',
    'تفاصيل',
    'FIN_DirectExpense_Category',
    'فئة',
    'Dropdown',
    'SYS_Dropdowns',
    'Key=DD_Cost_Categories',
    'Yes',
    '',
    'DD_Cost_Categories',
    'FIN_DirectExpenses',
    'Category',
    'ROLE_Finance',
  ]);
  add([
    'FORM_FIN_DirectExpense',
    'نموذج_مصروف_مباشر',
    'Tab_DirectExpenses',
    'المصروفات_المباشرة',
    'تفاصيل',
    'FIN_DirectExpense_Level_1',
    'المستوى_1',
    'Text',
    '',
    '',
    'No',
    '',
    '',
    'FIN_DirectExpenses',
    'Level_1',
    'ROLE_Finance',
  ]);
  add([
    'FORM_FIN_DirectExpense',
    'نموذج_مصروف_مباشر',
    'Tab_DirectExpenses',
    'المصروفات_المباشرة',
    'تفاصيل',
    'FIN_DirectExpense_Level_2',
    'المستوى_2',
    'Text',
    '',
    '',
    'No',
    '',
    '',
    'FIN_DirectExpenses',
    'Level_2',
    'ROLE_Finance',
  ]);
  add([
    'FORM_FIN_DirectExpense',
    'نموذج_مصروف_مباشر',
    'Tab_DirectExpenses',
    'المصروفات_المباشرة',
    'تفاصيل',
    'FIN_DirectExpense_Unit',
    'الوحدة',
    'Text',
    '',
    '',
    'No',
    '',
    '',
    'FIN_DirectExpenses',
    'Unit',
    'ROLE_Finance',
  ]);
  add([
    'FORM_FIN_DirectExpense',
    'نموذج_مصروف_مباشر',
    'Tab_DirectExpenses',
    'المصروفات_المباشرة',
    'تفاصيل',
    'FIN_DirectExpense_Qty',
    'الكمية',
    'Number',
    '',
    '',
    'No',
    '1',
    '',
    'FIN_DirectExpenses',
    'Qty',
    'ROLE_Finance',
  ]);
  add([
    'FORM_FIN_DirectExpense',
    'نموذج_مصروف_مباشر',
    'Tab_DirectExpenses',
    'المصروفات_المباشرة',
    'تفاصيل',
    'FIN_DirectExpense_Unit_Price',
    'سعر_الوحدة',
    'Currency',
    '',
    '',
    'No',
    '0',
    '',
    'FIN_DirectExpenses',
    'Unit_Price',
    'ROLE_Finance',
  ]);
  add([
    'FORM_FIN_DirectExpense',
    'نموذج_مصروف_مباشر',
    'Tab_DirectExpenses',
    'المصروفات_المباشرة',
    'تفاصيل',
    'FIN_DirectExpense_Amount',
    'المبلغ',
    'Currency',
    '',
    '',
    'Yes',
    '0',
    '',
    'FIN_DirectExpenses',
    'Amount',
    'ROLE_Finance',
  ]);
  add([
    'FORM_FIN_DirectExpense',
    'نموذج_مصروف_مباشر',
    'Tab_DirectExpenses',
    'المصروفات_المباشرة',
    'تفاصيل',
    'FIN_DirectExpense_VAT_Rate',
    'نسبة_VAT',
    'Number',
    '',
    '',
    'No',
    '0',
    '',
    'FIN_DirectExpenses',
    'VAT_Rate',
    'ROLE_Finance',
  ]);
  add([
    'FORM_FIN_DirectExpense',
    'نموذج_مصروف_مباشر',
    'Tab_DirectExpenses',
    'المصروفات_المباشرة',
    'تفاصيل',
    'FIN_DirectExpense_VAT_Amount',
    'مبلغ_VAT',
    'Currency',
    '',
    '',
    'No',
    '0',
    '',
    'FIN_DirectExpenses',
    'VAT_Amount',
    'ROLE_Finance',
  ]);
  add([
    'FORM_FIN_DirectExpense',
    'نموذج_مصروف_مباشر',
    'Tab_DirectExpenses',
    'المصروفات_المباشرة',
    'تفاصيل',
    'FIN_DirectExpense_Total_With_VAT',
    'الاجمالي_شامل_VAT',
    'Currency',
    '',
    '',
    'No',
    'Computed',
    '',
    'FIN_DirectExpenses',
    'Total_With_VAT',
    'ROLE_Finance',
  ]);
  add([
    'FORM_FIN_DirectExpense',
    'نموذج_مصروف_مباشر',
    'Tab_DirectExpenses',
    'المصروفات_المباشرة',
    'تفاصيل',
    'FIN_DirectExpense_Material_ID',
    'معرّف_المادة',
    'Dropdown',
    'PRJ_Materials',
    'A:A',
    'No',
    '',
    '',
    'FIN_DirectExpenses',
    'Material_ID',
    'ROLE_Finance',
  ]);
  add([
    'FORM_FIN_DirectExpense',
    'نموذج_مصروف_مباشر',
    'Tab_DirectExpenses',
    'المصروفات_المباشرة',
    'تفاصيل',
    'FIN_DirectExpense_Material_Name',
    'اسم_المادة',
    'Text',
    'PRJ_Materials',
    'Name_AR',
    'No',
    '',
    '',
    'FIN_DirectExpenses',
    'Material_Name',
    'ROLE_Finance',
  ]);
  add([
    'FORM_FIN_DirectExpense',
    'نموذج_مصروف_مباشر',
    'Tab_DirectExpenses',
    'المصروفات_المباشرة',
    'تفاصيل',
    'FIN_DirectExpense_Pay_Status',
    'حالة_الدفع',
    'Dropdown',
    'SYS_Dropdowns',
    'Key=DD_Pay_Status',
    'No',
    'Unpaid',
    'DD_Pay_Status',
    'FIN_DirectExpenses',
    'Pay_Status',
    'ROLE_Finance',
  ]);
  add([
    'FORM_FIN_DirectExpense',
    'نموذج_مصروف_مباشر',
    'Tab_DirectExpenses',
    'المصروفات_المباشرة',
    'تفاصيل',
    'FIN_DirectExpense_Pay_Method',
    'طريقة_الدفع',
    'Dropdown',
    'SYS_Dropdowns',
    'Key=DD_Payment_Methods',
    'No',
    'Cash',
    'DD_Payment_Methods',
    'FIN_DirectExpenses',
    'Pay_Method',
    'ROLE_Finance',
  ]);
  add([
    'FORM_FIN_DirectExpense',
    'نموذج_مصروف_مباشر',
    'Tab_DirectExpenses',
    'المصروفات_المباشرة',
    'ملاحظات',
    'FIN_DirectExpense_Notes',
    'ملاحظات',
    'Textarea',
    '',
    '',
    'No',
    '',
    '',
    'FIN_DirectExpenses',
    'Notes',
    'ROLE_Finance',
  ]);
  add([
    'FORM_FIN_DirectExpense',
    'نموذج_مصروف_مباشر',
    'Tab_DirectExpenses',
    'المصروفات_المباشرة',
    'تدقيق',
    'FIN_DirectExpense_Created_At',
    'تاريخ_الانشاء',
    'Auto',
    '',
    '',
    'Yes',
    '=NOW()',
    '',
    'FIN_DirectExpenses',
    'Created_At',
    'ROLE_Finance',
  ]);
  add([
    'FORM_FIN_DirectExpense',
    'نموذج_مصروف_مباشر',
    'Tab_DirectExpenses',
    'المصروفات_المباشرة',
    'تدقيق',
    'FIN_DirectExpense_Created_By',
    'من_انشأ',
    'Auto',
    'SYS_Users',
    'A:C',
    'Yes',
    'current_user',
    '',
    'FIN_DirectExpenses',
    'Created_By',
    'ROLE_Finance',
  ]);

  // --- FIN InDirExpense Repeated (full) ---
  add([
    'FORM_FIN_InDirExpense_Repeated',
    'نموذج_مصروف_غير_مباشر_متكرر',
    'Tab_Indirect_Costs',
    'المصروفات_غير_مباشرة',
    'مصروف_متكرر',
    'FIN_InDirExpense_Repeated_ID',
    'معرّف_المصروف_المتكرر',
    'Auto',
    '',
    '',
    'Yes',
    'AutoGenerate',
    '',
    'FIN_InDirExpense_Repeated',
    'InDirExpense_Repeated_ID',
    'ROLE_Finance',
  ]);
  add([
    'FORM_FIN_InDirExpense_Repeated',
    'نموذج_مصروف_غير_مباشر_متكرر',
    'Tab_Indirect_Costs',
    'المصروفات_غير_مباشرة',
    'مصروف_متكرر',
    'FIN_Category',
    'الفئة',
    'Dropdown',
    'SYS_Dropdowns',
    'Key=DD_Cost_Categories',
    'Yes',
    '',
    'DD_Cost_Categories',
    'FIN_InDirExpense_Repeated',
    'Category',
    'ROLE_Finance',
  ]);
  add([
    'FORM_FIN_InDirExpense_Repeated',
    'نموذج_مصروف_غير_مباشر_متكرر',
    'Tab_Indirect_Costs',
    'المصروفات_غير_مباشرة',
    'مصروف_متكرر',
    'FIN_Sub_Category',
    'الفئة_الفرعية',
    'Text',
    '',
    '',
    'No',
    '',
    '',
    'FIN_InDirExpense_Repeated',
    'Sub_Category',
    'ROLE_Finance',
  ]);
  add([
    'FORM_FIN_InDirExpense_Repeated',
    'نموذج_مصروف_غير_مباشر_متكرر',
    'Tab_Indirect_Costs',
    'المصروفات_غير_مباشرة',
    'مصروف_متكرر',
    'FIN_Pay_Date',
    'تاريخ_الدفع',
    'Date',
    '',
    '',
    'Yes',
    'TODAY()',
    '',
    'FIN_InDirExpense_Repeated',
    'Pay_Date',
    'ROLE_Finance',
  ]);
  add([
    'FORM_FIN_InDirExpense_Repeated',
    'نموذج_مصروف_غير_مباشر_متكرر',
    'Tab_Indirect_Costs',
    'المصروفات_غير_مباشرة',
    'مصروف_متكرر',
    'FIN_Start_Date',
    'تاريخ_البدء',
    'Date',
    '',
    '',
    'No',
    '',
    '',
    'FIN_InDirExpense_Repeated',
    'Start_Date',
    'ROLE_Finance',
  ]);
  add([
    'FORM_FIN_InDirExpense_Repeated',
    'نموذج_مصروف_غير_مباشر_متكرر',
    'Tab_Indirect_Costs',
    'المصروفات_غير_مباشرة',
    'مصروف_متكرر',
    'FIN_End_Date',
    'تاريخ_النهاية',
    'Date',
    '',
    '',
    'No',
    '',
    '',
    'FIN_InDirExpense_Repeated',
    'End_Date',
    'ROLE_Finance',
  ]);
  add([
    'FORM_FIN_InDirExpense_Repeated',
    'نموذج_مصروف_غير_مباشر_متكرر',
    'Tab_Indirect_Costs',
    'المصروفات_غير_مباشرة',
    'مصروف_متكرر',
    'FIN_Paid_By',
    'صرف_بواسطة',
    'Text',
    '',
    '',
    'No',
    '',
    '',
    'FIN_InDirExpense_Repeated',
    'Paid_By',
    'ROLE_Finance',
  ]);
  add([
    'FORM_FIN_InDirExpense_Repeated',
    'نموذج_مصروف_غير_مباشر_متكرر',
    'Tab_Indirect_Costs',
    'المصروفات_غير_مباشرة',
    'مصروف_متكرر',
    'FIN_Pay_Status',
    'حالة_الدفع',
    'Dropdown',
    'SYS_Dropdowns',
    'Key=DD_Pay_Status',
    'No',
    'Unpaid',
    'DD_Pay_Status',
    'FIN_InDirExpense_Repeated',
    'Pay_Status',
    'ROLE_Finance',
  ]);
  add([
    'FORM_FIN_InDirExpense_Repeated',
    'نموذج_مصروف_غير_مباشر_متكرر',
    'Tab_Indirect_Costs',
    'المصروفات_غير_مباشرة',
    'مصروف_متكرر',
    'FIN_Pay_Method',
    'طريقة_الدفع',
    'Dropdown',
    'SYS_Dropdowns',
    'Key=DD_Payment_Methods',
    'No',
    'Cash',
    'DD_Payment_Methods',
    'FIN_InDirExpense_Repeated',
    'Pay_Method',
    'ROLE_Finance',
  ]);
  add([
    'FORM_FIN_InDirExpense_Repeated',
    'نموذج_مصروف_غير_مباشر_متكرر',
    'Tab_Indirect_Costs',
    'المصروفات_غير_مباشرة',
    'مصروف_متكرر',
    'FIN_Amount',
    'المبلغ',
    'Currency',
    '',
    '',
    'Yes',
    '0',
    '',
    'FIN_InDirExpense_Repeated',
    'Amount',
    'ROLE_Finance',
  ]);
  add([
    'FORM_FIN_InDirExpense_Repeated',
    'نموذج_مصروف_غير_مباشر_متكرر',
    'Tab_Indirect_Costs',
    'المصروفات_غير_مباشرة',
    'مصروف_متكرر',
    'FIN_Notes',
    'ملاحظات',
    'Textarea',
    '',
    '',
    'No',
    '',
    '',
    'FIN_InDirExpense_Repeated',
    'Notes',
    'ROLE_Finance',
  ]);
  add([
    'FORM_FIN_InDirExpense_Repeated',
    'نموذج_مصروف_غير_مباشر_متكرر',
    'Tab_Indirect_Costs',
    'المصروفات_غير_مباشرة',
    'مصروف_متكرر',
    'FIN_Allocation_Method',
    'طريقة_التخصيص',
    'Dropdown',
    'SYS_Dropdowns',
    'Key=DD_Indirect_Methods',
    'No',
    '',
    'DD_Indirect_Methods',
    'FIN_InDirExpense_Repeated',
    'Allocation_Method',
    'ROLE_Finance',
  ]);

  // --- FIN InDirExpense Once (capex & depreciation) ---
  add([
    'FORM_FIN_InDirExpense_Once',
    'نموذج_مصروف_غير_مباشر_مرة',
    'Tab_Indirect_Costs',
    'المصروفات_غير_مباشرة',
    'مصروف_مرة',
    'FIN_InDirExpense_Once_ID',
    'InDirExpense_Once_ID',
    'Auto',
    '',
    '',
    'Yes',
    'AutoGenerate',
    '',
    'FIN_InDirExpense_Once',
    'InDirExpense_Once_ID',
    'ROLE_Finance',
  ]);
  add([
    'FORM_FIN_InDirExpense_Once',
    'نموذج_مصروف_غير_مباشر_مرة',
    'Tab_Indirect_Costs',
    'المصروفات_غير_مباشرة',
    'مصروف_مرة',
    'FIN_Category',
    'الفئة',
    'Dropdown',
    'SYS_Dropdowns',
    'Key=DD_Cost_Categories',
    'Yes',
    '',
    'DD_Cost_Categories',
    'FIN_InDirExpense_Once',
    'Category',
    'ROLE_Finance',
  ]);
  add([
    'FORM_FIN_InDirExpense_Once',
    'نموذج_مصروف_غير_مباشر_مرة',
    'Tab_Indirect_Costs',
    'المصروفات_غير_مباشرة',
    'مصروف_مرة',
    'FIN_Sub_Category',
    'الفئة_الفرعية',
    'Text',
    '',
    '',
    'No',
    '',
    '',
    'FIN_InDirExpense_Once',
    'Sub_Category',
    'ROLE_Finance',
  ]);
  add([
    'FORM_FIN_InDirExpense_Once',
    'نموذج_مصروف_غير_مباشر_مرة',
    'Tab_Indirect_Costs',
    'المصروفات_غير_مباشرة',
    'مصروف_مرة',
    'FIN_Pay_Date',
    'تاريخ_الدفع',
    'Date',
    '',
    '',
    'Yes',
    'TODAY()',
    '',
    'FIN_InDirExpense_Once',
    'Pay_Date',
    'ROLE_Finance',
  ]);
  add([
    'FORM_FIN_InDirExpense_Once',
    'نموذج_مصروف_غير_مباشر_مرة',
    'Tab_Indirect_Costs',
    'المصروفات_غير_مباشرة',
    'مصروف_مرة',
    'FIN_Yearly_Worth',
    'قيمة_سنويا',
    'Currency',
    '',
    '',
    'No',
    '0',
    '',
    'FIN_InDirExpense_Once',
    'Yearly_Worth',
    'ROLE_Finance',
  ]);
  add([
    'FORM_FIN_InDirExpense_Once',
    'نموذج_مصروف_غير_مباشر_مرة',
    'Tab_Indirect_Costs',
    'المصروفات_غير_مباشرة',
    'مصروف_مرة',
    'FIN_Useful_Life_Months',
    'عمر_افتراضي_بالاشهر',
    'Number',
    '',
    '',
    'No',
    '12',
    '',
    'FIN_InDirExpense_Once',
    'Useful_Life_Months',
    'ROLE_Finance',
  ]);
  add([
    'FORM_FIN_InDirExpense_Once',
    'نموذج_مصروف_غير_مباشر_مرة',
    'Tab_Indirect_Costs',
    'المصروفات_غير_مباشرة',
    'مصروف_مرة',
    'FIN_Depreciation_Start_Date',
    'بدء_الاهلاك',
    'Date',
    '',
    '',
    'No',
    '',
    '',
    'FIN_InDirExpense_Once',
    'Depreciation_Start_Date',
    'ROLE_Finance',
  ]);
  add([
    'FORM_FIN_InDirExpense_Once',
    'نموذج_مصروف_غير_مباشر_مرة',
    'Tab_Indirect_Costs',
    'المصروفات_غير_مباشرة',
    'مصروف_مرة',
    'FIN_Paid_By',
    'صرف_بواسطة',
    'Text',
    '',
    '',
    'No',
    '',
    '',
    'FIN_InDirExpense_Once',
    'Paid_By',
    'ROLE_Finance',
  ]);
  add([
    'FORM_FIN_InDirExpense_Once',
    'نموذج_مصروف_غير_مباشر_مرة',
    'Tab_Indirect_Costs',
    'المصروفات_غير_مباشرة',
    'مصروف_مرة',
    'FIN_Pay_Status',
    'حالة_الدفع',
    'Dropdown',
    'SYS_Dropdowns',
    'Key=DD_Pay_Status',
    'No',
    'Unpaid',
    'DD_Pay_Status',
    'FIN_InDirExpense_Once',
    'Pay_Status',
    'ROLE_Finance',
  ]);
  add([
    'FORM_FIN_InDirExpense_Once',
    'نموذج_مصروف_غير_مباشر_مرة',
    'Tab_Indirect_Costs',
    'المصروفات_غير_مباشرة',
    'مصروف_مرة',
    'FIN_Pay_Method',
    'طريقة_الدفع',
    'Dropdown',
    'SYS_Dropdowns',
    'Key=DD_Payment_Methods',
    'No',
    'Cash',
    'DD_Payment_Methods',
    'FIN_InDirExpense_Once',
    'Pay_Method',
    'ROLE_Finance',
  ]);
  add([
    'FORM_FIN_InDirExpense_Once',
    'نموذج_مصروف_غير_مباشر_مرة',
    'Tab_Indirect_Costs',
    'المصروفات_غير_مباشرة',
    'مصروف_مرة',
    'FIN_Notes',
    'ملاحظات',
    'Textarea',
    '',
    '',
    'No',
    '',
    '',
    'FIN_InDirExpense_Once',
    'Notes',
    'ROLE_Finance',
  ]);
  add([
    'FORM_FIN_InDirExpense_Once',
    'نموذج_مصروف_غير_مباشر_مرة',
    'Tab_Indirect_Costs',
    'المصروفات_غير_مباشرة',
    'مصروف_مرة',
    'FIN_Allocation_Method',
    'طريقة_التخصيص',
    'Dropdown',
    'SYS_Dropdowns',
    'Key=DD_Indirect_Methods',
    'No',
    '',
    'DD_Indirect_Methods',
    'FIN_InDirExpense_Once',
    'Allocation_Method',
    'ROLE_Finance',
  ]);

  // --- FIN Project Revenue (full) ---
  add([
    'FORM_FIN_Project_Revenue',
    'نموذج_ايراد_مشروع',
    'Tab_Revenue',
    'الإيرادات',
    'فاتورة_مشروع',
    'FIN_Revenue_ID',
    'Revenue_ID',
    'Auto',
    '',
    '',
    'Yes',
    'AutoGenerate',
    '',
    'FIN_Project_Revenue',
    'Revenue_ID',
    'ROLE_Finance',
  ]);
  add([
    'FORM_FIN_Project_Revenue',
    'نموذج_ايراد_مشروع',
    'Tab_Revenue',
    'الإيرادات',
    'فاتورة_مشروع',
    'FIN_Project_ID',
    'المشروع',
    'Dropdown',
    'PRJ_Main',
    'A:B',
    'Yes',
    '',
    'DD_Projects',
    'FIN_Project_Revenue',
    'Project_ID',
    'ROLE_Finance',
  ]);
  add([
    'FORM_FIN_Project_Revenue',
    'نموذج_ايراد_مشروع',
    'Tab_Revenue',
    'الإيرادات',
    'فاتورة_مشروع',
    'FIN_Revenue_Date',
    'تاريخ_الإيراد',
    'Date',
    '',
    '',
    'Yes',
    'TODAY()',
    '',
    'FIN_Project_Revenue',
    'Revenue_Date',
    'ROLE_Finance',
  ]);
  add([
    'FORM_FIN_Project_Revenue',
    'نموذج_ايراد_مشروع',
    'Tab_Revenue',
    'الإيرادات',
    'فاتورة_مشروع',
    'FIN_Amount',
    'المبلغ',
    'Currency',
    '',
    '',
    'Yes',
    '0',
    '',
    'FIN_Project_Revenue',
    'Amount',
    'ROLE_Finance',
  ]);
  add([
    'FORM_FIN_Project_Revenue',
    'نموذج_ايراد_مشروع',
    'Tab_Revenue',
    'الإيرادات',
    'فاتورة_مشروع',
    'FIN_Source',
    'المصدر',
    'Text',
    '',
    '',
    'No',
    '',
    '',
    'FIN_Project_Revenue',
    'Source',
    'ROLE_Finance',
  ]);
  add([
    'FORM_FIN_Project_Revenue',
    'نموذج_ايراد_مشروع',
    'Tab_Revenue',
    'الإيرادات',
    'فاتورة_مشروع',
    'FIN_Pay_Method',
    'طريقة_الدفع',
    'Dropdown',
    'SYS_Dropdowns',
    'Key=DD_Payment_Methods',
    'No',
    'BankTransfer',
    'DD_Payment_Methods',
    'FIN_Project_Revenue',
    'Pay_Method',
    'ROLE_Finance',
  ]);
  add([
    'FORM_FIN_Project_Revenue',
    'نموذج_ايراد_مشروع',
    'Tab_Revenue',
    'الإيرادات',
    'فاتورة_مشروع',
    'FIN_Invoice_Number',
    'رقم_الفاتورة',
    'Text',
    '',
    '',
    'No',
    '',
    '',
    'FIN_Project_Revenue',
    'Invoice_Number',
    'ROLE_Finance',
  ]);
  add([
    'FORM_FIN_Project_Revenue',
    'نموذج_ايراد_مشروع',
    'Tab_Revenue',
    'الإيرادات',
    'فاتورة_مشروع',
    'FIN_Pay_Status',
    'حالة_الدفع',
    'Dropdown',
    'SYS_Dropdowns',
    'Key=DD_Pay_Status',
    'Yes',
    'Unpaid',
    'DD_Pay_Status',
    'FIN_Project_Revenue',
    'Pay_Status',
    'ROLE_Finance',
  ]);
  add([
    'FORM_FIN_Project_Revenue',
    'نموذج_ايراد_مشروع',
    'Tab_Revenue',
    'الإيرادات',
    'فاتورة_مشروع',
    'FIN_Created_At',
    'تاريخ_الانشاء',
    'Auto',
    '',
    '',
    'Yes',
    '=NOW()',
    '',
    'FIN_Project_Revenue',
    'Created_At',
    'ROLE_Finance',
  ]);

  // --- FIN Journal Entry (basic) ---
  add([
    'FORM_FIN_Journal',
    'نموذج_قيد_محاسبي',
    'Tab_Journal',
    'القيود',
    'قيد',
    'FIN_Journal_ID',
    'Journal_ID',
    'Auto',
    '',
    '',
    'Yes',
    'AutoGenerate',
    '',
    'FIN_Journal',
    'Journal_ID',
    'ROLE_Accountant',
  ]);
  add([
    'FORM_FIN_Journal',
    'نموذج_قيد_محاسبي',
    'Tab_Journal',
    'القيود',
    'قيد',
    'FIN_Journal_Date',
    'التاريخ',
    'Date',
    '',
    '',
    'Yes',
    'TODAY()',
    '',
    'FIN_Journal',
    'Date',
    'ROLE_Accountant',
  ]);
  add([
    'FORM_FIN_Journal',
    'نموذج_قيد_محاسبي',
    'Tab_Journal',
    'القيود',
    'قيد',
    'FIN_Account_Dr',
    'حساب_مدين',
    'Text',
    'SYS_GL_Accounts',
    'Account_Code',
    'Yes',
    '',
    'DD_GL_Accounts',
    'FIN_Journal',
    'Account_Dr',
    'ROLE_Accountant',
  ]);
  add([
    'FORM_FIN_Journal',
    'نموذج_قيد_محاسبي',
    'Tab_Journal',
    'القيود',
    'قيد',
    'FIN_Account_Cr',
    'حساب_دائن',
    'Text',
    'SYS_GL_Accounts',
    'Account_Code',
    'Yes',
    '',
    'DD_GL_Accounts',
    'FIN_Journal',
    'Account_Cr',
    'ROLE_Accountant',
  ]);
  add([
    'FORM_FIN_Journal',
    'نموذج_قيد_محاسبي',
    'Tab_Journal',
    'القيود',
    'قيد',
    'FIN_Journal_Amount',
    'المبلغ',
    'Currency',
    '',
    '',
    'Yes',
    '0',
    '',
    'FIN_Journal',
    'Amount',
    'ROLE_Accountant',
  ]);
  add([
    'FORM_FIN_Journal',
    'نموذج_قيد_محاسبي',
    'Tab_Journal',
    'القيود',
    'قيد',
    'FIN_Journal_Project_ID',
    'المشروع',
    'Dropdown',
    'PRJ_Main',
    'A:B',
    'No',
    '',
    'DD_Projects',
    'FIN_Journal',
    'Project_ID',
    'ROLE_Accountant',
  ]);
  add([
    'FORM_FIN_Journal',
    'نموذج_قيد_محاسبي',
    'Tab_Journal',
    'القيود',
    'قيد',
    'FIN_Journal_Memo',
    'مذكرة',
    'Textarea',
    '',
    '',
    'No',
    '',
    '',
    'FIN_Journal',
    'Memo',
    'ROLE_Accountant',
  ]);
  add([
    'FORM_FIN_Journal',
    'نموذج_قيد_محاسبي',
    'Tab_Journal',
    'القيود',
    'قيد',
    'FIN_Journal_Created_At',
    'تاريخ_الانشاء',
    'Auto',
    '',
    '',
    'Yes',
    '=NOW()',
    '',
    'FIN_Journal',
    'Created_At',
    'ROLE_Accountant',
  ]);

  // --- SYS: minimal forms (roles, permissions edit) ---
  add([
    'FORM_SYS_Role',
    'نموذج_دور',
    'Tab_Sys',
    'النظام',
    'ادارة_الادوار',
    'SYS_Role_ID',
    'Role_ID',
    'Auto',
    '',
    '',
    'Yes',
    'AutoGenerate',
    '',
    'SYS_Roles',
    'Role_ID',
    'ROLE_Admin',
  ]);
  add([
    'FORM_SYS_Permission',
    'نموذج_صلاحية',
    'Tab_Sys',
    'النظام',
    'ادارة_الصلاحيات',
    'SYS_Perm_ID',
    'Permission_ID',
    'Auto',
    '',
    '',
    'Yes',
    'AutoGenerate',
    '',
    'SYS_Permissions',
    'Permission_ID',
    'ROLE_Admin',
  ]);

  // Append if sheet empty
  appendRowsIfEmpty(sh, rows);
}

/* ---------- Seed admin user ---------- */

function seedAdminUser(ss, username, email, passwordPlain) {
  const headers = getHeaders('SYS_Users');
  const sh = ensureHeaders('SYS_Users', headers);
  const data = sh.getDataRange().getValues();
  const headerRow = data.length ? data[0] : headers;
  const usernameIdx = headerRow.indexOf('Username');
  if (usernameIdx !== -1 && data.length > 1) {
    for (let i = 1; i < data.length; i++) {
      if (normalizeUsername(String(data[i][usernameIdx])) === normalizeUsername(username)) {
        Logger.log('Admin user already exists in SYS_Users: ' + username);
        return;
      }
    }
  }

  const nowIso = ensureISODate(new Date());
  const usersSheetName =
    typeof SHEETS !== 'undefined' && SHEETS.SYS_USERS ? SHEETS.SYS_USERS : 'SYS_Users';
  const userId = createPrefixedId('USR', usersSheetName);
  const passwordHash = hashPassword_(passwordPlain);
  const record = {
    User_Id: userId,
    Full_Name: 'Admin User',
    Username: normalizeUsername(username),
    Email: normalizeEmail(email),
    Job_Title: 'System Administrator',
    Department: '',
    Role_Id: 'Admin',
    IsActive: true,
    Disabled_At: '',
    Disabled_By: '',
    Password_Hash: passwordHash,
    Last_Login: '',
    Created_At: nowIso,
    Created_By: SYSTEM_USER,
    Updated_At: nowIso,
    Updated_By: SYSTEM_USER,
    External_Id: '',
    MFA_Enabled: false,
    Notes: 'Seed admin user',
  };

  const row = headerRow.map(function (header) {
    return record.hasOwnProperty(header) ? record[header] : '';
  });
  sh.appendRow(row);
  Logger.log('Admin user created: ' + username + ' (user_id=' + userId + ')');
}

/* ---------- Utility functions ---------- */

function appendRowsIfEmpty(sheet, rows) {
  // If sheet has more than header row return (to avoid multiple seeding)
  const lastRow = sheet.getLastRow();
  if (lastRow > 1) {
    Logger.log('Sheet ' + sheet.getName() + ' not empty — skipping seed.');
    return;
  }
  if (!rows || rows.length === 0) {
    return;
  }
  sheet.getRange(2, 1, rows.length, rows[0].length).setValues(rows);
}

function findRowIndexByColumnValue(data, colIndex1Based, value) {
  // data is array of arrays from getValues(); returns 0-based row index or -1
  for (let i = 0; i < data.length; i++) {
    if (data[i][colIndex1Based - 1] === value) return i;
  }
  return -1;
}

function bytesToHex(bytes) {
  return bytes
    .map(function (b) {
      const v = b < 0 ? b + 256 : b;
      return ('0' + v.toString(16)).slice(-2);
    })
    .join('');
}
